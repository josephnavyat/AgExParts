import{r as i,j as e,u as U,L as V,g as K}from"./index-CxIS0fO9.js";/* empty css                       */import{g as O}from"./getImageUrl-uc-Sp53x.js";function X({src:d,alt:w="",className:p,style:C,loading:E="lazy",onLoad:W,onError:k,sizes:z,srcSet:g}){const j=i.useRef(0),[A,b]=i.useState(()=>{if(!d)return"/logo.png";const l=String(d).trim();return l.startsWith("http://")||l.startsWith("https://")?l:O(l)}),v=()=>{j.current+=1;const l=j.current;try{const n=String(d||"").trim().split("/").pop(),y=n.lastIndexOf("."),m=y!==-1?n.slice(0,y):n,N=y!==-1?n.slice(y):"";if(l===1){const x=m+".webp";b(O(x));return}if(l===2){const x=`${m}_2${N}`;b(O(x));return}if(l===3){const x=`${m}.thumb.webp`;b(O(x));return}}catch{}b("/logo.png")},P=l=>{j.current<3?v():b("/logo.png"),typeof k=="function"&&k(l)};return e.jsx("img",{src:A,alt:w,className:p,style:C,loading:E,onError:P,onLoad:W,sizes:z,srcSet:g})}function se(){window.matchMedia("(max-width: 700px)").matches;const[d,w]=i.useState([]),[p,C]=i.useState([]),[E,W]=i.useState(!0),[k,z]=i.useState(null),[g,j]=i.useState(!1),[A,b]=i.useState(!1),[v,P]=i.useState(""),[l,F]=i.useState(""),[n,y]=i.useState(""),[m,N]=i.useState(""),[x,B]=i.useState(""),[h,$]=i.useState(""),[_,D]=i.useState("");i.useEffect(()=>{const t=new AbortController;return(async()=>{try{const o=await fetch("/.netlify/functions/get-data",{signal:t.signal});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const u=await o.json();Array.isArray(u)?(w(u),C([])):u&&Array.isArray(u.products)?(w(u.products),C(Array.isArray(u.compatibility)?u.compatibility:[]),Array.isArray(u.compat_links)?M(u.compat_links):M([])):(w([]),C([]),M([]))}catch(o){o.name!=="AbortError"&&z(o.message+(o.response?" "+JSON.stringify(o.response):""))}finally{W(!1)}})(),()=>t.abort()},[]);const[L,q]=i.useState(50),[S,I]=i.useState(1),{dispatch:H,cart:G}=U(),[R,M]=i.useState([]);return e.jsxs("div",{className:"simple-gallery-root",role:"main",children:[e.jsxs("div",{className:"simple-gallery-header",children:[e.jsx("h2",{className:"simple-gallery-title distressed",children:"Agex Parts"}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:e.jsxs("div",{className:"simple-gallery-perpage",children:[e.jsx("label",{className:"filter-label",htmlFor:"perPageSelect",children:"Show:"}),e.jsx("select",{id:"perPageSelect",className:"filter-select",value:L,onChange:t=>{q(Number(t.target.value)),I(1)},children:[24,48,72,96].map(t=>e.jsxs("option",{value:t,children:[t," per page"]},t))})]})}),e.jsx("button",{className:"simple-gallery-filter-toggle","aria-label":g?"Hide Filters":"Show Filters","aria-pressed":g,"aria-controls":"gallery-filter-pane",onClick:()=>j(t=>!t),style:{position:"fixed",left:0,top:100,zIndex:100,background:"#3a3939",color:"#f3f3f3",border:"none",borderRadius:"0 8px 8px 0",padding:"0.7rem 0.9rem",fontWeight:700,fontSize:"1.1rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",cursor:"pointer",transition:"top 0.3s",display:"block"},id:"filter-toggle-btn",children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),e.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),e.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),e.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),e.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),e.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),e.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:600},children:"Filter"})]})})]}),e.jsx("hr",{className:"simple-gallery-divider"}),e.jsxs("div",{className:"simple-gallery-layout",style:{position:"relative"},children:[e.jsxs("aside",{id:"gallery-filter-pane",className:`simple-gallery-filter-pane${g?"":" simple-gallery-filter-pane--closed"}`,"aria-label":"Product Filters","aria-hidden":!g,tabIndex:g?0:-1,style:{position:"fixed",left:g?0:-340,top:156,zIndex:99,minWidth:260,maxWidth:340,height:"fit-content",marginTop:0,transition:"top 0.3s, left 0.3s"},children:[e.jsxs("div",{className:"simple-gallery-filter-header",style:{cursor:"pointer"},onClick:()=>j(t=>!t),children:["Filters ",g?"▼":"▶"]}),e.jsxs("div",{className:"simple-gallery-filter-content",children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"0.25rem 0 0.5rem 0"},children:e.jsxs("button",{title:"Clear filters","aria-label":"Clear filters",onClick:()=>{F(""),y(""),N(""),$(""),D(""),P(""),b(!1),B(""),I(1),j(!1)},style:{background:"transparent",border:"none",color:"#444",cursor:"pointer",padding:"0.35rem 0.6rem",borderRadius:6,display:"flex",alignItems:"center",gap:8,fontWeight:600},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"4",rx:"1",ry:"1"}),e.jsx("path",{d:"M6 8v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("span",{style:{fontSize:"0.95rem"},children:"Clear filters"})]})}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search...",value:v,onChange:t=>P(t.target.value),list:"product-names-list"}),e.jsx("datalist",{id:"product-names-list",children:[...new Set(d.filter(t=>{const s=String(t.name||"").toLowerCase();return String(t.category||"").toLowerCase()!=="demo"&&!s.includes("demo")&&!s.includes("sample")}).map(t=>t.name).filter(Boolean))].map(t=>e.jsx("option",{value:t},t))}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Category"}),e.jsxs("select",{value:h,onChange:t=>$(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"All Categories"}),[...new Set(d.map(t=>t.category).filter(Boolean))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sub-Category"}),(()=>{const t=h?[...new Set(d.filter(s=>s.category===h).map(s=>s.subcategory).filter(Boolean))]:[];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:_,onChange:s=>D(s.target.value),className:"filter-select",disabled:!h,title:h?t.length===0?"No sub-categories available":"Filter by sub-category":"Select a category first",children:[e.jsx("option",{value:"",children:"All Sub-Categories"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),!h&&e.jsx("div",{className:"filter-hint",children:"Select a category to enable sub-categories"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Manufacturer"}),(()=>{const t=[...new Set((p.length?p.map(s=>s.manufacturer):d.map(s=>s.manufacturer)).filter(Boolean))];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:l,onChange:s=>{F(s.target.value),y(""),N("")},className:"filter-select",children:[e.jsx("option",{value:"",children:"All Manufacturers"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),t.length===0&&e.jsx("div",{className:"filter-hint",children:"No manufacturers available"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Machine Type"}),(()=>{const t=[...new Set((p.length?p.filter(s=>!l||s.manufacturer===l).map(s=>s.machine_type):d.map(s=>s.machine_type)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:n,onChange:s=>{y(s.target.value),N("")},className:"filter-select",disabled:!l,title:l?t.length===0?"No machine types available":"Filter by machine type":"Select a manufacturer to see machine types",children:[e.jsx("option",{value:"",children:"All Machine Types"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Model"}),(()=>{const t=[...new Set((p.length?p.filter(s=>(!l||s.manufacturer===l)&&(!n||s.machine_type===n)).map(s=>s.model):d.map(s=>s.model)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:m,onChange:s=>N(s.target.value),className:"filter-select",disabled:!n,title:n?t.length===0?"No models available":"Filter by model":"Select a machine type to see models",children:[e.jsx("option",{value:"",children:"All Models"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sort by"}),e.jsxs("select",{value:x,onChange:t=>B(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"price-asc",children:"Price: Low to High"}),e.jsx("option",{value:"price-desc",children:"Price: High to Low"})]})]})]})]}),e.jsxs("div",{className:"simple-gallery-grid",style:{marginLeft:"",transition:"none"},children:[k?e.jsxs("div",{style:{padding:24,textAlign:"center",color:"red"},role:"alert",children:["Failed to load products: ",k]}):(()=>{const t=!!(l||n||m),s=p.length&&R.length&&t,o=(()=>{if(s){const r={};R.forEach(a=>{!a.machine_compatibility_id||!a.product_sku||(r[a.machine_compatibility_id]=r[a.machine_compatibility_id]||new Set,r[a.machine_compatibility_id].add(a.product_sku))});const c=p.filter(a=>!l||a.manufacturer===l).filter(a=>!n||a.machine_type===n).filter(a=>!m||a.model===m).map(a=>a.id),f=new Set;return c.forEach(a=>{(r[a]||[]).forEach(T=>f.add(T))}),f.size===0?[]:d.filter(a=>f.has(a.sku))}return d})().filter(r=>r.website_visible===!0).filter(r=>!h||r.category===h).filter(r=>!_||r.subcategory===_).filter(r=>s?!0:!l||r.manufacturer===l).filter(r=>s?!0:!n||r.machine_type===n).filter(r=>s?!0:!m||r.model===m).filter(r=>!A||r.quantity>0).filter(r=>{if(!v.trim())return!0;const c=v.toLowerCase();return Object.values(r).some(f=>typeof f=="string"&&f.toLowerCase().includes(c))}).sort((r,c)=>x==="price-asc"?(r.price||0)-(c.price||0):x==="price-desc"?(c.price||0)-(r.price||0):0),u=(S-1)*L,J=u+L;return t&&o.length===0?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#666"},role:"status",children:"No items matched filters."},"no-results"):o.slice(u,J).map(r=>e.jsxs(V,{to:`/product/${r.id}`,className:"simple-gallery-card",style:{textDecoration:"none"},children:[e.jsx("div",{className:"simple-gallery-image-wrapper",children:e.jsx(X,{src:r.image,alt:r.name,loading:"lazy"})}),r.sku&&e.jsx("div",{className:"simple-gallery-sku",children:r.sku}),e.jsx("h3",{className:"simple-gallery-card-title",title:r.name,children:r.name}),e.jsx("div",{className:"simple-gallery-part-number",children:r.part_number}),e.jsx("div",{className:"simple-gallery-card-price",style:{margin:"8px 0 0 0",fontSize:"1.15rem",fontWeight:700},children:(()=>{const c=Number(r.price),f=Number(r.discount_perc)||0,a=r.discount_end_date?new Date(r.discount_end_date):null,T=new Date;if(f>0&&(!a||T<=a)&&!isNaN(c)){const Q=(c*(1-f)).toFixed(2);return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"price-original",children:["$",c.toFixed(2)]}),e.jsxs("span",{className:"price-current",children:["$",Q]})]})}else return isNaN(c)?e.jsx("span",{className:"price-current",children:"Price N/A"}):e.jsxs("span",{className:"price-current",children:["$",c.toFixed(2)]})})()}),e.jsx("div",{className:"simple-gallery-card-actions",role:"group","aria-label":"Product Actions",children:(()=>{const c=K(G,r.id);return Number(r.inventory??r.quantity??0)===0?e.jsx("button",{className:"simple-gallery-btn",title:"Out of Stock","aria-label":"Out of Stock",disabled:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,background:"#d33",color:"#fff",border:"none",padding:"0.5rem 0.9rem",borderRadius:6,cursor:"not-allowed",opacity:.9},children:e.jsx("span",{style:{fontWeight:800,fontSize:"0.98rem"},children:"Out of Stock"})}):e.jsxs("button",{className:"simple-gallery-btn primary",onClick:a=>{a.stopPropagation(),a.preventDefault(),H({type:"ADD_TO_CART",product:r})},title:"Add to Cart","aria-label":"Add to Cart",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,position:"relative"},children:[e.jsx("span",{className:"add-to-cart-label",style:{fontWeight:800,fontSize:"0.98rem"},children:"Add to Cart"}),c>0&&e.jsx("span",{className:"qty-bubble",children:c})]})})()})]},r.id))})(),e.jsx("div",{className:"simple-gallery-pagination",children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem auto 0 auto",gap:12,width:"100%"},children:[S>1&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>I(S-1),children:"< Prev"}),e.jsxs("span",{style:{color:"#c3c3c3",fontWeight:500,fontSize:"1.05rem",margin:"0 1rem"},children:["Page ",S]}),d.filter(t=>!h||t.category===h).filter(t=>!_||t.subcategory===_).filter(t=>!l||t.manufacturer===l).filter(t=>!n||t.machine_type===n).filter(t=>!m||t.model===m).filter(t=>!A||t.quantity>0).filter(t=>{if(!v.trim())return!0;const s=v.toLowerCase();return Object.values(t).some(o=>typeof o=="string"&&o.toLowerCase().includes(s))}).length>S*L&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>I(S+1),children:"Next >"})]})})]})]})]})}export{se as default};
