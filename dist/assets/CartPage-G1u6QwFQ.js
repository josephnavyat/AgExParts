import{u as E,R as k,b as B,r as A,j as e}from"./index-gi7GTMaL.js";import{Q as F}from"./QuantityInput-1hGV7dDw.js";import{L as P}from"./LimitTooltip-BWWIkD2v.js";import{N as O}from"./Navbar-BEaLdVHS.js";import{F as U}from"./Footer-D3O5h3LD.js";import{g as Q}from"./imageUrl-CI4-tccc.js";const R=i=>Q(i);function I(i){const l=i.reduce((n,c)=>n+(c.product.weight||0)*c.quantity,0),x=n=>typeof n=="number"?n/25.4:0,N=n=>{const c=[n.length_mm,n.width_mm,n.height_mm].filter(s=>typeof s=="number"&&s>0);if(c.length)return Math.max(...c.map(x));const W=[n.length,n.width,n.height].filter(s=>typeof s=="number"&&s>0);return W.length?Math.max(...W):0},h=Math.max(...i.map(n=>N(n.product))),S=i.reduce((n,c)=>n+Number(c.product.price)*c.quantity,0);let d=0;return l<=2?d=10:l<=10?d=20:l<=25?d=35:l<=50?d=60:d=150,h>48?{type:"freight",cost:150}:(h>36?d+=25:h>24&&(d+=10),S>2e3&&(d=0),{type:"ground",cost:d})}function J(){const{cart:i,dispatch:l,limitMap:x,showLimit:N}=E(),[h,S]=k.useState(()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(max-width:420px) and (orientation: portrait)").matches||!1);k.useEffect(()=>{if(!window||!window.matchMedia)return;const t=window.matchMedia("(max-width:420px) and (orientation: portrait)"),r=a=>S(a.matches);try{t.addEventListener("change",r)}catch{t.addListener(r)}return()=>{try{t.removeEventListener("change",r)}catch{t.removeListener(r)}}},[]);const d=B(),n=i.items.reduce((t,r)=>{const a=Number(r.product.price),p=Number(r.product.discount_perc)||0,u=r.product.discount_end_date?new Date(r.product.discount_end_date):null,T=new Date,f=p>0&&(!u||T<=u)&&!isNaN(a)?a*(1-p):a;return t+f*r.quantity},0),[c,W]=A.useState({name:"",street1:"",city:"",state:"",zip:"",country:"US"});i.items.some(t=>t.quantity>Number(t.product.inventory??0)),i.items.filter(t=>Number(t.product.inventory??0)>0&&t.quantity>=Number(t.product.inventory??0));const[s,_]=A.useState(()=>I(i.items));k.useEffect(()=>{_(I(i.items))},[i.items]);const D=i.items.reduce((t,r)=>t+(r.product.weight||0)*r.quantity,0),C=n,m=i.shipping||null,q=m?Number(m.cost||0):s&&s.type!=="freight"?Number(s.cost||0):0,M=(s==null?void 0:s.type)==="freight"||m&&m.rateId&&m.cost>0&&!1,z=0,$=C+z+(m?Number(m.cost||0):0);return e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsxs("div",{style:{minHeight:"80vh",padding:"2rem",background:"var(--bg)",boxSizing:"border-box"},children:[e.jsx("h2",{className:"distressed gallery-title",style:{textAlign:"center",marginBottom:"2rem",color:"#222",textShadow:"0 1px 4px #fff, 0 0px 1px #bbb",fontSize:"2rem",wordBreak:"break-word"},children:"Shopping Cart"}),i.items.length===0?e.jsx("div",{style:{textAlign:"center",color:"#444",fontSize:"1.2rem",fontWeight:500},children:"Your cart is empty."}):e.jsxs("div",{className:"cart-page-content",style:{maxWidth:800,margin:"0 auto",background:"#fff",borderRadius:16,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222",boxSizing:"border-box",width:"100%"},children:[!h&&e.jsxs("div",{className:"cart-header-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:800,margin:"0 auto",padding:"0 0.5rem 0.5rem 0.5rem",color:"#666",fontSize:"0.95rem",boxSizing:"border-box"},children:[e.jsx("div",{style:{flex:1}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{minWidth:100,textAlign:"right"},children:"Price"}),e.jsx("div",{style:{width:120,textAlign:"center"},children:"Qty"}),e.jsx("div",{style:{minWidth:110,textAlign:"right"},children:"Total"})]})]}),e.jsx("div",{className:"cart-cards",style:{display:"flex",flexDirection:"column",gap:"1rem"},children:i.items.map(({product:t,quantity:r})=>{const a=Number(t.price),p=Number(t.discount_perc)||0,u=t.discount_end_date?new Date(t.discount_end_date):null,T=new Date,j=p>0&&(!u||T<=u),f=j&&!isNaN(a)?Number((a*(1-p)).toFixed(2)):a,v=isNaN(f)?0:f*r;return e.jsx("div",{className:"cart-card",style:{display:"flex",flexDirection:"column",background:"#f8f8f8",borderRadius:12,padding:"1rem",boxShadow:"0 1px 4px #eee",width:"100%"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,width:"100%"},children:[t.image&&e.jsx("img",{src:R(t.image),alt:t.name,style:{width:60,height:60,objectFit:"cover",borderRadius:8,boxShadow:"0 1px 4px #ccc"},loading:"lazy",onError:o=>{console.log("Image error:",t.image,R(t.image)),o.currentTarget.src="/logo.png"}}),e.jsx("div",{style:{flex:1,minWidth:0},children:e.jsxs("div",{className:"cart-item-inner",style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{className:"cart-item-header",style:{display:"flex",alignItems:"flex-start",gap:12},children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsx("span",{className:"cart-product-name",style:{fontWeight:700,fontSize:"1.05rem",display:"block",marginBottom:6},children:t.name.length>100?t.name.slice(0,100)+"…":t.name}),t.sku&&e.jsxs("span",{className:"cart-product-sku",style:{fontSize:"0.95rem",color:"#666",display:"block",marginBottom:2},children:["SKU: ",t.sku]}),e.jsxs("span",{className:"cart-product-weight",style:{fontSize:"0.95rem",color:"#388e3c",display:"block",marginTop:2},children:["Weight: ",t.weight?t.weight+" lbs":"N/A"]})]}),!h&&e.jsxs("div",{className:"cart-desktop-controls",style:{display:"flex",alignItems:"center",gap:12,marginLeft:12,flex:"0 0 auto"},children:[e.jsx("div",{className:"cart-price",style:{textAlign:"right",minWidth:100,fontWeight:700,fontSize:"1.05rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsx("div",{style:{fontSize:"0.95rem",color:j?"#d32f2f":"#222"},children:isNaN(f)?"N/A":`$${f.toFixed(2)}`}),j&&!isNaN(a)&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"#888",textDecoration:"line-through"},children:["$",a.toFixed(2)]})]})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:4},children:[e.jsxs("div",{className:"cart-qty-controls",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{style:{background:"#fff",color:"#333",border:"1px solid #d6d6d6",borderRadius:6,width:32,height:32,fontWeight:700,fontSize:"1.2rem",cursor:"pointer"},onClick:()=>{l({type:"SUBTRACT_FROM_CART",product:t})},"aria-label":"Decrease quantity",children:"-"}),e.jsx(F,{initialValue:r,product:t,dispatch:l}),(()=>{const o=Number(t.inventory??t.quantity??0),b=i.items.find(w=>w.product.id===t.id),y=b?b.quantity:0,g=Number.isFinite(o)&&o>0&&y>=o;return e.jsx("button",{style:{background:g?"#f7f7f7":"#fff",color:g?"#999":"#333",border:"1px solid #d6d6d6",borderRadius:6,width:32,height:32,fontWeight:700,fontSize:"1.2rem",cursor:g?"not-allowed":"pointer"},onClick:()=>{if(g)return;const w=y+1;if(Number.isFinite(o)&&o>0&&w>o){N(t.id);return}l({type:"ADD_TO_CART",product:t})},"aria-label":"Increase quantity",children:"+"})})()]}),e.jsx("div",{style:{position:"relative"},children:x[t.id]&&e.jsx("div",{role:"status","aria-live":"polite",style:{position:"absolute",top:-34,left:"50%",transform:"translateX(-50%)",backgroundColor:"#d32f2f",border:"1px solid #b71c1c",color:"#ffffff",WebkitTextFillColor:"#ffffff",padding:"6px 8px",borderRadius:6,fontSize:12,fontWeight:700,boxShadow:"0 6px 18px rgba(0,0,0,0.12)",whiteSpace:"nowrap",zIndex:9999,pointerEvents:"none"},children:x[t.id]})}),e.jsx(P,{productId:t.id})]}),e.jsx("div",{className:"cart-line-total",style:{textAlign:"right",minWidth:110,fontWeight:800,fontSize:"1.05rem"},children:isNaN(v)?"Total N/A":`$${v.toFixed(2)}`})]})]}),e.jsx("hr",{className:"cart-divider",style:{border:"none",borderTop:"1px solid rgba(0,0,0,0.06)",margin:6}}),h&&e.jsx("div",{className:"cart-mobile-summary",style:{marginTop:8,paddingTop:8},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{className:"mobile-qty-btn","aria-label":"Decrease quantity",onClick:()=>{l({type:"SUBTRACT_FROM_CART",product:t})},style:{width:36,height:36,borderRadius:8,border:"1px solid #ddd",background:"#fff",fontWeight:700},children:"−"}),e.jsx(F,{initialValue:r,product:t,dispatch:l,updateOnBlurOnly:!0}),e.jsx("button",{className:"mobile-qty-btn","aria-label":"Increase quantity",onClick:()=>{const o=Number(t.inventory??t.quantity??0),b=i.items.find(L=>L.product.id===t.id),y=b?b.quantity:0,g=y+1;if(!(Number.isFinite(o)&&o>0&&y>=o)){if(Number.isFinite(o)&&o>0&&g>o){N(t.id);return}l({type:"ADD_TO_CART",product:t})}},style:{width:36,height:36,borderRadius:8,border:"1px solid #ddd",background:"#fff",fontWeight:700,cursor:"pointer"},children:"+"}),e.jsx("div",{style:{position:"relative"},children:x[t.id]&&e.jsx("div",{role:"status","aria-live":"polite",style:{position:"absolute",top:-34,left:"50%",transform:"translateX(-50%)",backgroundColor:"#d32f2f",border:"1px solid #b71c1c",color:"#ffffff",WebkitTextFillColor:"#ffffff",padding:"6px 8px",borderRadius:6,fontSize:12,fontWeight:700,boxShadow:"0 6px 18px rgba(0,0,0,0.12)",whiteSpace:"nowrap",zIndex:9999,pointerEvents:"none"},children:x[t.id]})}),e.jsx("div",{style:{marginLeft:12,color:"#666"},children:`× $${isNaN(f)?"N/A":f.toFixed(2)}`})]}),e.jsx("div",{className:"line-total",style:{fontWeight:800},children:isNaN(v)?"Total N/A":`$${v.toFixed(2)}`})]})})]})})]})},t.id)})}),e.jsxs("div",{className:"cart-summary",style:{textAlign:"right",marginTop:"2rem"},children:[e.jsxs("div",{style:{fontWeight:700,fontSize:"1.2rem",wordBreak:"break-word"},children:["Subtotal: $",C.toFixed(2)]}),e.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Total Weight: ",D.toFixed(2)," lbs"]}),e.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Shipping: ",M?"Need to Quote (Freight)":m?`${m.label} — $${q.toFixed(2)}`:"TBD"]}),e.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Tax: $",z.toFixed(2)]}),e.jsxs("div",{style:{fontWeight:800,fontSize:"1.25rem",color:"#222",marginTop:"0.75rem"},children:["Total: $",$.toFixed(2)]})]}),e.jsxs("div",{style:{textAlign:"right",marginTop:"1rem",display:"flex",flexWrap:"wrap",gap:12,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn danger",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",minWidth:120,background:"#d32f2f",color:"#fff",border:"none",boxShadow:"0 2px 8px rgba(211,47,47,0.10)"},onClick:()=>{l({type:"CLEAR_CART"})},children:"Clear Cart"}),(s==null?void 0:s.type)==="freight"?e.jsx("button",{className:"btn freight",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",minWidth:180,background:"#557a2cff",color:"#fff",border:"none",boxShadow:"0 2px 8px rgba(139,195,74,0.10)",cursor:"pointer"},onClick:()=>d("/freight-inquiry",{state:{cart:i}}),children:"Get Freight Quote"}):e.jsx("button",{className:"btn primary",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",marginLeft:"1rem"},onClick:()=>d("/checkout"),children:"Checkout"})]})]})]}),e.jsx(U,{})]})}export{J as default};
