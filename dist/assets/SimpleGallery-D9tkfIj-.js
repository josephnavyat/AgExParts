import{r as n,u as Q,j as e,L as U,g as V}from"./index-BPhBAx7Z.js";/* empty css                       */import{g as K}from"./getImageUrl-uc-Sp53x.js";function se(){window.matchMedia("(max-width: 700px)").matches;const[h,w]=n.useState([]),[g,C]=n.useState([]),[X,B]=n.useState(!0),[L,$]=n.useState(null),[x,k]=n.useState(!1),[W,D]=n.useState(!1),[j,O]=n.useState(""),[c,I]=n.useState(""),[m,A]=n.useState(""),[f,v]=n.useState(""),[_,E]=n.useState(""),[p,T]=n.useState(""),[b,z]=n.useState("");n.useEffect(()=>{const t=new AbortController;return(async()=>{try{const a=await fetch("/.netlify/functions/get-data",{signal:t.signal});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const o=await a.json();Array.isArray(o)?(w(o),C([])):o&&Array.isArray(o.products)?(w(o.products),C(Array.isArray(o.compatibility)?o.compatibility:[]),Array.isArray(o.compat_links)?P(o.compat_links):P([])):(w([]),C([]),P([]))}catch(a){a.name!=="AbortError"&&$(a.message+(a.response?" "+JSON.stringify(a.response):""))}finally{B(!1)}})(),()=>t.abort()},[]);const[N,R]=n.useState(50),[y,S]=n.useState(1),{dispatch:q,cart:H}=Q(),[M,P]=n.useState([]),G=t=>{const s=t.currentTarget,a=Number(s.dataset.attempts||0);s.dataset.attempts=a+1;const o=s.getAttribute("src")||"",u=o.startsWith(window.location.origin)?o.slice(window.location.origin.length):o,l=u.split("/").pop()||"";if(a===0){const i=l.toLowerCase();if(i!==l){const d=u.replace(new RegExp(l+"$"),i);s.src=d.startsWith("/")?d:`/${d}`;return}}if(a===1&&u&&u.startsWith("/")){s.src=window.location.origin+u;return}if(a===2){const i=u.startsWith("/")?u.slice(1):u;s.src=i||"/logo.png";return}s.src="/logo.png"};return e.jsxs("div",{className:"simple-gallery-root",role:"main",children:[e.jsxs("div",{className:"simple-gallery-header",children:[e.jsx("h2",{className:"simple-gallery-title distressed",children:"Agex Parts"}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:e.jsxs("div",{className:"simple-gallery-perpage",children:[e.jsx("label",{className:"filter-label",htmlFor:"perPageSelect",children:"Show:"}),e.jsx("select",{id:"perPageSelect",className:"filter-select",value:N,onChange:t=>{R(Number(t.target.value)),S(1)},children:[24,48,72,96].map(t=>e.jsxs("option",{value:t,children:[t," per page"]},t))})]})}),e.jsx("button",{className:"simple-gallery-filter-toggle","aria-label":x?"Hide Filters":"Show Filters","aria-pressed":x,"aria-controls":"gallery-filter-pane",onClick:()=>k(t=>!t),style:{position:"fixed",left:0,top:100,zIndex:100,background:"#3a3939",color:"#f3f3f3",border:"none",borderRadius:"0 8px 8px 0",padding:"0.7rem 0.9rem",fontWeight:700,fontSize:"1.1rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",cursor:"pointer",transition:"top 0.3s",display:"block"},id:"filter-toggle-btn",children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),e.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),e.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),e.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),e.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),e.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),e.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:600},children:"Filter"})]})})]}),e.jsx("hr",{className:"simple-gallery-divider"}),e.jsxs("div",{className:"simple-gallery-layout",style:{position:"relative"},children:[e.jsxs("aside",{id:"gallery-filter-pane",className:`simple-gallery-filter-pane${x?"":" simple-gallery-filter-pane--closed"}`,"aria-label":"Product Filters","aria-hidden":!x,tabIndex:x?0:-1,style:{position:"fixed",left:x?0:-340,top:156,zIndex:99,minWidth:260,maxWidth:340,height:"fit-content",marginTop:0,transition:"top 0.3s, left 0.3s"},children:[e.jsxs("div",{className:"simple-gallery-filter-header",style:{cursor:"pointer"},onClick:()=>k(t=>!t),children:["Filters ",x?"▼":"▶"]}),e.jsxs("div",{className:"simple-gallery-filter-content",children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"0.25rem 0 0.5rem 0"},children:e.jsxs("button",{title:"Clear filters","aria-label":"Clear filters",onClick:()=>{I(""),A(""),v(""),T(""),z(""),O(""),D(!1),E(""),S(1),k(!1)},style:{background:"transparent",border:"none",color:"#444",cursor:"pointer",padding:"0.35rem 0.6rem",borderRadius:6,display:"flex",alignItems:"center",gap:8,fontWeight:600},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"4",rx:"1",ry:"1"}),e.jsx("path",{d:"M6 8v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("span",{style:{fontSize:"0.95rem"},children:"Clear filters"})]})}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search...",value:j,onChange:t=>O(t.target.value),list:"product-names-list"}),e.jsx("datalist",{id:"product-names-list",children:[...new Set(h.filter(t=>{const s=String(t.name||"").toLowerCase();return String(t.category||"").toLowerCase()!=="demo"&&!s.includes("demo")&&!s.includes("sample")}).map(t=>t.name).filter(Boolean))].map(t=>e.jsx("option",{value:t},t))}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Category"}),e.jsxs("select",{value:p,onChange:t=>T(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"All Categories"}),[...new Set(h.map(t=>t.category).filter(Boolean))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sub-Category"}),(()=>{const t=p?[...new Set(h.filter(s=>s.category===p).map(s=>s.subcategory).filter(Boolean))]:[];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:b,onChange:s=>z(s.target.value),className:"filter-select",disabled:!p,title:p?t.length===0?"No sub-categories available":"Filter by sub-category":"Select a category first",children:[e.jsx("option",{value:"",children:"All Sub-Categories"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),!p&&e.jsx("div",{className:"filter-hint",children:"Select a category to enable sub-categories"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Manufacturer"}),(()=>{const t=[...new Set((g.length?g.map(s=>s.manufacturer):h.map(s=>s.manufacturer)).filter(Boolean))];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:c,onChange:s=>{I(s.target.value),A(""),v("")},className:"filter-select",children:[e.jsx("option",{value:"",children:"All Manufacturers"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),t.length===0&&e.jsx("div",{className:"filter-hint",children:"No manufacturers available"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Machine Type"}),(()=>{const t=[...new Set((g.length?g.filter(s=>!c||s.manufacturer===c).map(s=>s.machine_type):h.map(s=>s.machine_type)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:m,onChange:s=>{A(s.target.value),v("")},className:"filter-select",disabled:!c,title:c?t.length===0?"No machine types available":"Filter by machine type":"Select a manufacturer to see machine types",children:[e.jsx("option",{value:"",children:"All Machine Types"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Model"}),(()=>{const t=[...new Set((g.length?g.filter(s=>(!c||s.manufacturer===c)&&(!m||s.machine_type===m)).map(s=>s.model):h.map(s=>s.model)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:f,onChange:s=>v(s.target.value),className:"filter-select",disabled:!m,title:m?t.length===0?"No models available":"Filter by model":"Select a machine type to see models",children:[e.jsx("option",{value:"",children:"All Models"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sort by"}),e.jsxs("select",{value:_,onChange:t=>E(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"price-asc",children:"Price: Low to High"}),e.jsx("option",{value:"price-desc",children:"Price: High to Low"})]})]})]})]}),e.jsxs("div",{className:"simple-gallery-grid",style:{marginLeft:"",transition:"none"},children:[L?e.jsxs("div",{style:{padding:24,textAlign:"center",color:"red"},role:"alert",children:["Failed to load products: ",L]}):(()=>{const t=!!(c||m||f),s=g.length&&M.length&&t,a=(()=>{if(s){const l={};M.forEach(r=>{!r.machine_compatibility_id||!r.product_sku||(l[r.machine_compatibility_id]=l[r.machine_compatibility_id]||new Set,l[r.machine_compatibility_id].add(r.product_sku))});const i=g.filter(r=>!c||r.manufacturer===c).filter(r=>!m||r.machine_type===m).filter(r=>!f||r.model===f).map(r=>r.id),d=new Set;return i.forEach(r=>{(l[r]||[]).forEach(F=>d.add(F))}),d.size===0?[]:h.filter(r=>d.has(r.sku))}return h})().filter(l=>l.website_visible===!0).filter(l=>!p||l.category===p).filter(l=>!b||l.subcategory===b).filter(l=>s?!0:!c||l.manufacturer===c).filter(l=>s?!0:!m||l.machine_type===m).filter(l=>s?!0:!f||l.model===f).filter(l=>!W||l.quantity>0).filter(l=>{if(!j.trim())return!0;const i=j.toLowerCase();return Object.values(l).some(d=>typeof d=="string"&&d.toLowerCase().includes(i))}).sort((l,i)=>_==="price-asc"?(l.price||0)-(i.price||0):_==="price-desc"?(i.price||0)-(l.price||0):0),o=(y-1)*N,u=o+N;return t&&a.length===0?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#666"},role:"status",children:"No items matched filters."},"no-results"):a.slice(o,u).map(l=>e.jsxs(U,{to:`/product/${l.id}`,className:"simple-gallery-card",style:{textDecoration:"none"},children:[e.jsx("div",{className:"simple-gallery-image-wrapper",children:e.jsx("img",{src:K(l.image),alt:l.name,loading:"lazy",onError:G})}),l.sku&&e.jsx("div",{className:"simple-gallery-sku",children:l.sku}),e.jsx("h3",{className:"simple-gallery-card-title",title:l.name,children:l.name}),e.jsx("div",{className:"simple-gallery-part-number",children:l.part_number}),e.jsx("div",{className:"simple-gallery-card-price",style:{margin:"8px 0 0 0",fontSize:"1.15rem",fontWeight:700},children:(()=>{const i=Number(l.price),d=Number(l.discount_perc)||0,r=l.discount_end_date?new Date(l.discount_end_date):null,F=new Date;if(d>0&&(!r||F<=r)&&!isNaN(i)){const J=(i*(1-d)).toFixed(2);return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"price-original",children:["$",i.toFixed(2)]}),e.jsxs("span",{className:"price-current",children:["$",J]})]})}else return isNaN(i)?e.jsx("span",{className:"price-current",children:"Price N/A"}):e.jsxs("span",{className:"price-current",children:["$",i.toFixed(2)]})})()}),e.jsx("div",{className:"simple-gallery-card-actions",role:"group","aria-label":"Product Actions",children:(()=>{const i=V(H,l.id);return Number(l.inventory??l.quantity??0)===0?e.jsx("button",{className:"simple-gallery-btn",title:"Out of Stock","aria-label":"Out of Stock",disabled:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,background:"#d33",color:"#fff",border:"none",padding:"0.5rem 0.9rem",borderRadius:6,cursor:"not-allowed",opacity:.9},children:e.jsx("span",{style:{fontWeight:800,fontSize:"0.98rem"},children:"Out of Stock"})}):e.jsxs("button",{className:"simple-gallery-btn primary",onClick:r=>{r.stopPropagation(),r.preventDefault(),q({type:"ADD_TO_CART",product:l})},title:"Add to Cart","aria-label":"Add to Cart",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,position:"relative"},children:[e.jsx("span",{className:"add-to-cart-label",style:{fontWeight:800,fontSize:"0.98rem"},children:"Add to Cart"}),i>0&&e.jsx("span",{className:"qty-bubble",children:i})]})})()})]},l.id))})(),e.jsx("div",{className:"simple-gallery-pagination",children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem auto 0 auto",gap:12,width:"100%"},children:[y>1&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>S(y-1),children:"< Prev"}),e.jsxs("span",{style:{color:"#c3c3c3",fontWeight:500,fontSize:"1.05rem",margin:"0 1rem"},children:["Page ",y]}),h.filter(t=>!p||t.category===p).filter(t=>!b||t.subcategory===b).filter(t=>!c||t.manufacturer===c).filter(t=>!m||t.machine_type===m).filter(t=>!f||t.model===f).filter(t=>!W||t.quantity>0).filter(t=>{if(!j.trim())return!0;const s=j.toLowerCase();return Object.values(t).some(a=>typeof a=="string"&&a.toLowerCase().includes(s))}).length>y*N&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>S(y+1),children:"Next >"})]})})]})]})]})}export{se as default};
