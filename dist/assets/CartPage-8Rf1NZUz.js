import{R as T,u as O,b as U,r as q,j as t}from"./index-PZtE8jMc.js";import{N as Q}from"./Navbar-BThQrc94.js";import{F as V}from"./Footer-sikTjvGv.js";import{g as X}from"./imageUrl-BC-b4leq.js";import{Q as _}from"./QuantityInput-CgpvvZHz.js";const D=d=>X(d);function I(d){const g=d.reduce((r,c)=>r+(c.product.weight||0)*c.quantity,0),j=r=>typeof r=="number"?r/25.4:0,s=r=>{const c=[r.length_mm,r.width_mm,r.height_mm].filter(y=>typeof y=="number"&&y>0);if(c.length)return Math.max(...c.map(j));const k=[r.length,r.width,r.height].filter(y=>typeof y=="number"&&y>0);return k.length?Math.max(...k):0},o=Math.max(...d.map(r=>s(r.product))),p=d.reduce((r,c)=>r+Number(c.product.price)*c.quantity,0);let l=0;return g<=2?l=10:g<=10?l=20:g<=25?l=35:g<=50?l=60:l=150,o>48?{type:"freight",cost:150}:(o>36?l+=25:o>24&&(l+=10),p>2e3&&(l=0),{type:"ground",cost:l})}function Z(){const[d,g]=T.useState({}),j=(e,i="Reached inventory limit")=>{g(a=>({...a,[e]:i})),setTimeout(()=>g(a=>{const h={...a};return delete h[e],h}),1800)},{cart:s,dispatch:o}=O(),[p,l]=T.useState(()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(max-width:420px) and (orientation: portrait)").matches||!1);T.useEffect(()=>{if(!window||!window.matchMedia)return;const e=window.matchMedia("(max-width:420px) and (orientation: portrait)"),i=a=>l(a.matches);try{e.addEventListener("change",i)}catch{e.addListener(i)}return()=>{try{e.removeEventListener("change",i)}catch{e.removeListener(i)}}},[]);const r=U(),c=s.items.reduce((e,i)=>{const a=Number(i.product.price),h=Number(i.product.discount_perc)||0,b=i.product.discount_end_date?new Date(i.product.discount_end_date):null,C=new Date,x=h>0&&(!b||C<=b)&&!isNaN(a)?a*(1-h):a;return e+x*i.quantity},0),[k,y]=q.useState({name:"",street1:"",city:"",state:"",zip:"",country:"US"});s.items.some(e=>e.quantity>Number(e.product.inventory??0)),s.items.filter(e=>Number(e.product.inventory??0)>0&&e.quantity>=Number(e.product.inventory??0));const[m,M]=q.useState(()=>I(s.items));T.useEffect(()=>{M(I(s.items))},[s.items]);const $=s.items.reduce((e,i)=>e+(i.product.weight||0)*i.quantity,0),F=c,f=s.shipping||null,L=f?Number(f.cost||0):m&&m.type!=="freight"?Number(m.cost||0):0,E=(m==null?void 0:m.type)==="freight"||f&&f.rateId&&f.cost>0&&!1,z=0,B=F+z+(f?Number(f.cost||0):0);return t.jsxs(t.Fragment,{children:[t.jsx(Q,{}),t.jsxs("div",{style:{minHeight:"80vh",padding:"2rem",background:"var(--bg)",boxSizing:"border-box"},children:[t.jsx("h2",{className:"distressed gallery-title",style:{textAlign:"center",marginBottom:"2rem",color:"#222",textShadow:"0 1px 4px #fff, 0 0px 1px #bbb",fontSize:"2rem",wordBreak:"break-word"},children:"Shopping Cart"}),s.items.length===0?t.jsx("div",{style:{textAlign:"center",color:"#444",fontSize:"1.2rem",fontWeight:500},children:"Your cart is empty."}):t.jsxs("div",{className:"cart-page-content",style:{maxWidth:800,margin:"0 auto",background:"#fff",borderRadius:16,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222",boxSizing:"border-box",width:"100%"},children:[!p&&t.jsxs("div",{className:"cart-header-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:800,margin:"0 auto",padding:"0 0.5rem 0.5rem 0.5rem",color:"#666",fontSize:"0.95rem",boxSizing:"border-box"},children:[t.jsx("div",{style:{flex:1}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx("div",{style:{minWidth:100,textAlign:"right"},children:"Price"}),t.jsx("div",{style:{width:120,textAlign:"center"},children:"Qty"}),t.jsx("div",{style:{minWidth:110,textAlign:"right"},children:"Total"})]})]}),t.jsx("div",{className:"cart-cards",style:{display:"flex",flexDirection:"column",gap:"1rem"},children:s.items.map(({product:e,quantity:i})=>{var A,R;const a=Number(e.price),h=Number(e.discount_perc)||0,b=e.discount_end_date?new Date(e.discount_end_date):null,C=new Date,w=h>0&&(!b||C<=b),x=w&&!isNaN(a)?Number((a*(1-h)).toFixed(2)):a,S=isNaN(x)?0:x*i;return t.jsx("div",{className:"cart-card",style:{display:"flex",flexDirection:"column",background:"#f8f8f8",borderRadius:12,padding:"1rem",boxShadow:"0 1px 4px #eee",width:"100%"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,width:"100%"},children:[e.image&&t.jsx("img",{src:D(e.image),alt:e.name,style:{width:60,height:60,objectFit:"cover",borderRadius:8,boxShadow:"0 1px 4px #ccc"},loading:"lazy",onError:n=>{console.log("Image error:",e.image,D(e.image)),n.currentTarget.src="/logo.png"}}),t.jsx("div",{style:{flex:1,minWidth:0},children:t.jsxs("div",{className:"cart-item-inner",style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsxs("div",{className:"cart-item-header",style:{display:"flex",alignItems:"flex-start",gap:12},children:[t.jsxs("div",{style:{minWidth:0,flex:1},children:[t.jsx("span",{className:"cart-product-name",style:{fontWeight:700,fontSize:"1.05rem",display:"block",marginBottom:6},children:e.name.length>100?e.name.slice(0,100)+"…":e.name}),e.sku&&t.jsxs("span",{className:"cart-product-sku",style:{fontSize:"0.95rem",color:"#666",display:"block",marginBottom:2},children:["SKU: ",e.sku]}),t.jsxs("span",{className:"cart-product-weight",style:{fontSize:"0.95rem",color:"#388e3c",display:"block",marginTop:2},children:["Weight: ",e.weight?e.weight+" lbs":"N/A"]})]}),!p&&t.jsxs("div",{className:"cart-desktop-controls",style:{display:"flex",alignItems:"center",gap:12,marginLeft:12,flex:"0 0 auto"},children:[t.jsx("div",{className:"cart-price",style:{textAlign:"right",minWidth:100,fontWeight:700,fontSize:"1.05rem"},children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[t.jsx("div",{style:{fontSize:"0.95rem",color:w?"#d32f2f":"#222"},children:isNaN(x)?"N/A":`$${x.toFixed(2)}`}),w&&!isNaN(a)&&t.jsxs("div",{style:{fontSize:"0.85rem",color:"#888",textDecoration:"line-through"},children:["$",a.toFixed(2)]})]})}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:4},children:[t.jsxs("div",{className:"cart-qty-controls",style:{display:"flex",alignItems:"center",gap:8},children:[t.jsx("button",{style:{background:"#fff",color:"#333",border:"1px solid #d6d6d6",borderRadius:6,width:32,height:32,fontWeight:700,fontSize:"1.2rem",cursor:"pointer"},onClick:()=>{o({type:"SUBTRACT_FROM_CART",product:e})},"aria-label":"Decrease quantity",children:"-"}),t.jsx(_,{initialValue:i,product:e,dispatch:o}),(()=>{const n=Number(e.inventory??e.quantity??0),v=s.items.find(W=>W.product.id===e.id),N=v?v.quantity:0,u=Number.isFinite(n)&&n>0&&N>=n;return t.jsx("button",{style:{background:u?"#f7f7f7":"#fff",color:u?"#999":"#333",border:"1px solid #d6d6d6",borderRadius:6,width:32,height:32,fontWeight:700,fontSize:"1.2rem",cursor:u?"not-allowed":"pointer"},onClick:()=>{if(u)return;const W=N+1;if(Number.isFinite(n)&&n>0&&W>n){j(e.id);return}o({type:"ADD_TO_CART",product:e})},"aria-label":"Increase quantity",disabled:u,children:"+"})})()]}),t.jsx("div",{style:{position:"relative"},children:d[e.id]&&t.jsx("div",{role:"status","aria-live":"polite",style:{position:"absolute",top:-34,left:"50%",transform:"translateX(-50%)",backgroundColor:"#d32f2f",border:"1px solid #b71c1c",color:"#ffffff",WebkitTextFillColor:"#ffffff",padding:"6px 8px",borderRadius:6,fontSize:12,fontWeight:700,boxShadow:"0 6px 18px rgba(0,0,0,0.12)",whiteSpace:"nowrap",zIndex:9999,pointerEvents:"none"},children:d[e.id]})})]}),t.jsx("div",{className:"cart-line-total",style:{textAlign:"right",minWidth:110,fontWeight:800,fontSize:"1.05rem"},children:isNaN(S)?"Total N/A":`$${S.toFixed(2)}`})]})]}),t.jsx("hr",{className:"cart-divider",style:{border:"none",borderTop:"1px solid rgba(0,0,0,0.06)",margin:6}}),p&&t.jsx("div",{className:"cart-mobile-summary",style:{marginTop:8,paddingTop:8},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.jsx("button",{className:"mobile-qty-btn","aria-label":"Decrease quantity",onClick:()=>{o({type:"SUBTRACT_FROM_CART",product:e})},style:{width:36,height:36,borderRadius:8,border:"1px solid #ddd",background:"#fff",fontWeight:700},children:"−"}),t.jsx(_,{initialValue:i,product:e,dispatch:o,updateOnBlurOnly:!0}),t.jsx("button",{className:"mobile-qty-btn","aria-label":"Increase quantity",onClick:()=>{const n=Number(e.inventory??e.quantity??0),v=s.items.find(P=>P.product.id===e.id),N=v?v.quantity:0,u=N+1;if(!(Number.isFinite(n)&&n>0&&N>=n)){if(Number.isFinite(n)&&n>0&&u>n){j(e.id);return}o({type:"ADD_TO_CART",product:e})}},style:{width:36,height:36,borderRadius:8,border:"1px solid #ddd",background:"#fff",fontWeight:700,cursor:Number.isFinite(e.inventory??e.quantity??0)&&(((A=s.items.find(n=>n.product.id===e.id))==null?void 0:A.quantity)||0)>=Number(e.inventory??e.quantity??0)?"not-allowed":"pointer"},disabled:Number.isFinite(e.inventory??e.quantity??0)&&(((R=s.items.find(n=>n.product.id===e.id))==null?void 0:R.quantity)||0)>=Number(e.inventory??e.quantity??0),children:"+"}),t.jsx("div",{style:{position:"relative"},children:d[e.id]&&t.jsx("div",{role:"status","aria-live":"polite",style:{position:"absolute",top:-34,left:"50%",transform:"translateX(-50%)",backgroundColor:"#d32f2f",border:"1px solid #b71c1c",color:"#ffffff",WebkitTextFillColor:"#ffffff",padding:"6px 8px",borderRadius:6,fontSize:12,fontWeight:700,boxShadow:"0 6px 18px rgba(0,0,0,0.12)",whiteSpace:"nowrap",zIndex:9999,pointerEvents:"none"},children:d[e.id]})}),t.jsx("div",{style:{marginLeft:12,color:"#666"},children:`× $${isNaN(x)?"N/A":x.toFixed(2)}`})]}),t.jsx("div",{className:"line-total",style:{fontWeight:800},children:isNaN(S)?"Total N/A":`$${S.toFixed(2)}`})]})})]})})]})},e.id)})}),t.jsxs("div",{className:"cart-summary",style:{textAlign:"right",marginTop:"2rem"},children:[t.jsxs("div",{style:{fontWeight:700,fontSize:"1.2rem",wordBreak:"break-word"},children:["Subtotal: $",F.toFixed(2)]}),t.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Total Weight: ",$.toFixed(2)," lbs"]}),t.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Shipping: ",E?"Need to Quote (Freight)":f?`${f.label} — $${L.toFixed(2)}`:"TBD"]}),t.jsxs("div",{style:{fontWeight:500,fontSize:"1.05rem",color:"#555",marginTop:"0.5rem"},children:["Tax: $",z.toFixed(2)]}),t.jsxs("div",{style:{fontWeight:800,fontSize:"1.25rem",color:"#222",marginTop:"0.75rem"},children:["Total: $",B.toFixed(2)]})]}),t.jsxs("div",{style:{textAlign:"right",marginTop:"1rem",display:"flex",flexWrap:"wrap",gap:12,justifyContent:"flex-end"},children:[t.jsx("button",{className:"btn danger",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",minWidth:120,background:"#d32f2f",color:"#fff",border:"none",boxShadow:"0 2px 8px rgba(211,47,47,0.10)"},onClick:()=>{o({type:"CLEAR_CART"})},children:"Clear Cart"}),(m==null?void 0:m.type)==="freight"?t.jsx("button",{className:"btn freight",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",minWidth:180,background:"#557a2cff",color:"#fff",border:"none",boxShadow:"0 2px 8px rgba(139,195,74,0.10)",cursor:"pointer"},onClick:()=>r("/freight-inquiry",{state:{cart:s}}),children:"Get Freight Quote"}):t.jsx("button",{className:"btn primary",style:{fontWeight:700,fontSize:"1.1rem",borderRadius:8,padding:"0.7rem 2rem",marginLeft:"1rem"},onClick:()=>r("/checkout"),children:"Checkout"})]})]})]}),t.jsx(V,{})]})}export{Z as default};
