import{R as N,j as S}from"./index-PZtE8jMc.js";function m({initialValue:T,product:e,dispatch:a,immediateDispatch:b=!1,updateOnBlurOnly:l=!1,onLimit:s,stopPropagation:u=!1}){const[f,y]=N.useState(()=>String(Number(T||0)));return N.useEffect(()=>{y(String(Number(T||0)))},[T]),N.useEffect(()=>{if(b||l)return;const n=Number(f||0),t=Number(T||0);if(n===t)return;const r=setTimeout(()=>{const i=Number(e.inventory??e.quantity??0);Number.isFinite(i)&&i>0&&n>i?(s&&s(e.id),a({type:"SET_QUANTITY",product:e,quantity:i}),y(String(i))):(a({type:"SET_QUANTITY",product:e,quantity:n}),y(String(n)))},600);return()=>clearTimeout(r)},[f,T,e,a,b,l,s]),S.jsx("input",{"aria-label":`Quantity for ${e&&e.name?e.name:""}`,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:f,className:"qty-input",onMouseDown:n=>{u&&n.stopPropagation()},onClick:n=>{u&&n.stopPropagation()},onChange:n=>{const t=(n.target.value||"").replace(/\D/g,"");if(y(t),b){const r=Number(t||0),i=Number(e.inventory??e.quantity??0);Number.isFinite(i)&&i>0&&r>i?(s&&s(e.id),a({type:"SET_QUANTITY",product:e,quantity:i}),y(String(i))):a({type:"SET_QUANTITY",product:e,quantity:r})}},onKeyDown:n=>{if(n.key==="Enter"){const t=Number(f||0),r=Number(e.inventory??e.quantity??0);Number.isFinite(r)&&r>0&&t>r?(s&&s(e.id),a({type:"SET_QUANTITY",product:e,quantity:r}),y(String(r))):(a({type:"SET_QUANTITY",product:e,quantity:t}),y(String(t)))}},onBlur:()=>{const n=Number(f||0),t=Number(e.inventory??e.quantity??0);Number.isFinite(t)&&t>0&&n>t?(s&&s(e.id),a({type:"SET_QUANTITY",product:e,quantity:t}),y(String(t))):(a({type:"SET_QUANTITY",product:e,quantity:n}),y(String(n)))},style:{width:`${Math.max(1,Math.min((f||"").length||0,4))}ch`,textAlign:"center",fontWeight:600,color:"#222",fontSize:"1.1rem",padding:"6px 8px",borderRadius:6,border:"1px solid #d6d6d6",boxSizing:"content-box"}})}export{m as Q};
