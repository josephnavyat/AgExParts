import{r as a,j as o,R as Ie,L as le}from"./index-PZtE8jMc.js";import{N as Ue}from"./Navbar-BThQrc94.js";import{r as Ve,u as qe,c as Be,a as $e,b as Ke,d as _e,G as He,T as ze,D as Je,e as Ye,f as Qe,g as fe,h as Xe,i as Ze,j as et,k as X,l as Ne,m as tt,s as ot,n as rt,o as nt,B as O,P as st,p as P,q as L}from"./Paper-Bq-FEi1s.js";import{R as at,T as E}from"./TextField-B4Dht6_e.js";import"./imageUrl-BC-b4leq.js";function it(e){const{theme:t,name:r,props:s}=e;return!t||!t.components||!t.components[r]||!t.components[r].defaultProps?s:Ve(t.components[r].defaultProps,s)}function lt({props:e,name:t,defaultTheme:r,themeId:s}){let i=qe(r);return s&&(i=i[s]||i),it({theme:i,name:t,props:e})}const ct=Be(),We=a.createContext(null);function he(){return a.useContext(We)}const dt=typeof Symbol=="function"&&Symbol.for,ut=dt?Symbol.for("mui.nested"):"__THEME_NESTED__";function mt(e,t){return typeof t=="function"?t(e):{...e,...t}}function ft(e){const{children:t,theme:r}=e,s=he(),i=a.useMemo(()=>{const h=s===null?{...r}:mt(s,r);return h!=null&&(h[ut]=s!==null),h},[r,s]);return o.jsx(We.Provider,{value:i,children:t})}function ht(e){const t=$e(),r=Ke()||"",{modularCssLayers:s}=e;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!s||t!==null?i="":typeof s=="string"?i=s.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,_e(()=>{var c,m;const h=document.querySelector("head");if(!h)return;const n=h.firstChild;if(i){if(n&&((c=n.hasAttribute)!=null&&c.call(n,"data-mui-layer-order"))&&n.getAttribute("data-mui-layer-order")===r)return;const S=document.createElement("style");S.setAttribute("data-mui-layer-order",r),S.textContent=i,h.prepend(S)}else(m=h.querySelector(`style[data-mui-layer-order="${r}"]`))==null||m.remove()},[i,r]),i?o.jsx(He,{styles:i}):null}const Ee={};function Pe(e,t,r,s=!1){return a.useMemo(()=>{const i=e&&t[e]||t;if(typeof r=="function"){const h=r(i),n=e?{...t,[e]:h}:h;return s?()=>n:n}return e?{...t,[e]:r}:{...t,...r}},[e,t,r,s])}function De(e){const{children:t,theme:r,themeId:s}=e,i=$e(Ee),h=he()||Ee,n=Pe(s,i,r),c=Pe(s,h,r,!0),m=(s?n[s]:n).direction==="rtl",S=ht(n);return o.jsx(ft,{theme:c,children:o.jsx(ze.Provider,{value:n,children:o.jsx(at,{value:m,children:o.jsxs(Je,{value:s?n[s].components:n.components,children:[S,t]})})})})}const pe="mode",xe="color-scheme",pt="data-color-scheme";function xt(e){const{defaultMode:t="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:s="dark",modeStorageKey:i=pe,colorSchemeStorageKey:h=xe,attribute:n=pt,colorSchemeNode:c="document.documentElement",nonce:m}=e||{};let S="",y=n;if(n==="class"&&(y=".%s"),n==="data"&&(y="[data-%s]"),y.startsWith(".")){const g=y.substring(1);S+=`${c}.classList.remove('${g}'.replace('%s', light), '${g}'.replace('%s', dark));
      ${c}.classList.add('${g}'.replace('%s', colorScheme));`}const k=y.match(/\[([^[\]]+)\]/);if(k){const[g,x]=k[1].split("=");x||(S+=`${c}.removeAttribute('${g}'.replace('%s', light));
      ${c}.removeAttribute('${g}'.replace('%s', dark));`),S+=`
      ${c}.setAttribute('${g}'.replace('%s', colorScheme), ${x?`${x}.replace('%s', colorScheme)`:'""'});`}else S+=`${c}.setAttribute('${y}', colorScheme);`;return o.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?m:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${t}';
  const dark = localStorage.getItem('${h}-dark') || '${s}';
  const light = localStorage.getItem('${h}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${S}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function gt(){}const yt=({key:e,storageWindow:t})=>(!t&&typeof window<"u"&&(t=window),{get(r){if(typeof window>"u")return;if(!t)return r;let s;try{s=t.localStorage.getItem(e)}catch{}return s||r},set:r=>{if(t)try{t.localStorage.setItem(e,r)}catch{}},subscribe:r=>{if(!t)return gt;const s=i=>{const h=i.newValue;i.key===e&&r(h)};return t.addEventListener("storage",s),()=>{t.removeEventListener("storage",s)}}});function me(){}function Le(e){if(typeof window<"u"&&typeof window.matchMedia=="function"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Re(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function St(e){return Re(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function Ct(e){const{defaultMode:t="light",defaultLightColorScheme:r,defaultDarkColorScheme:s,supportedColorSchemes:i=[],modeStorageKey:h=pe,colorSchemeStorageKey:n=xe,storageWindow:c=typeof window>"u"?void 0:window,storageManager:m=yt,noSsr:S=!1}=e,y=i.join(","),k=i.length>1,g=a.useMemo(()=>m==null?void 0:m({key:h,storageWindow:c}),[m,h,c]),x=a.useMemo(()=>m==null?void 0:m({key:`${n}-light`,storageWindow:c}),[m,n,c]),C=a.useMemo(()=>m==null?void 0:m({key:`${n}-dark`,storageWindow:c}),[m,n,c]),[$,F]=a.useState(()=>{const f=(g==null?void 0:g.get(t))||t,u=(x==null?void 0:x.get(r))||r,p=(C==null?void 0:C.get(s))||s;return{mode:f,systemMode:Le(f),lightColorScheme:u,darkColorScheme:p}}),[_,I]=a.useState(S||!k);a.useEffect(()=>{I(!0)},[]);const K=St($),U=a.useCallback(f=>{F(u=>{if(f===u.mode)return u;const p=f??t;return g==null||g.set(p),{...u,mode:p,systemMode:Le(p)}})},[g,t]),V=a.useCallback(f=>{f?typeof f=="string"?f&&!y.includes(f)?console.error(`\`${f}\` does not exist in \`theme.colorSchemes\`.`):F(u=>{const p={...u};return Re(u,b=>{b==="light"&&(x==null||x.set(f),p.lightColorScheme=f),b==="dark"&&(C==null||C.set(f),p.darkColorScheme=f)}),p}):F(u=>{const p={...u},b=f.light===null?r:f.light,G=f.dark===null?s:f.dark;return b&&(y.includes(b)?(p.lightColorScheme=b,x==null||x.set(b)):console.error(`\`${b}\` does not exist in \`theme.colorSchemes\`.`)),G&&(y.includes(G)?(p.darkColorScheme=G,C==null||C.set(G)):console.error(`\`${G}\` does not exist in \`theme.colorSchemes\`.`)),p}):F(u=>(x==null||x.set(r),C==null||C.set(s),{...u,lightColorScheme:r,darkColorScheme:s}))},[y,x,C,r,s]),q=a.useCallback(f=>{$.mode==="system"&&F(u=>{const p=f!=null&&f.matches?"dark":"light";return u.systemMode===p?u:{...u,systemMode:p}})},[$.mode]),H=a.useRef(q);return H.current=q,a.useEffect(()=>{if(typeof window.matchMedia!="function"||!k)return;const f=(...p)=>H.current(...p),u=window.matchMedia("(prefers-color-scheme: dark)");return u.addListener(f),f(u),()=>{u.removeListener(f)}},[k]),a.useEffect(()=>{if(k){const f=(g==null?void 0:g.subscribe(b=>{(!b||["light","dark","system"].includes(b))&&U(b||t)}))||me,u=(x==null?void 0:x.subscribe(b=>{(!b||y.match(b))&&V({light:b})}))||me,p=(C==null?void 0:C.subscribe(b=>{(!b||y.match(b))&&V({dark:b})}))||me;return()=>{f(),u(),p()}}},[V,U,y,t,c,k,g,x,C]),{...$,mode:_?$.mode:void 0,systemMode:_?$.systemMode:void 0,colorScheme:_?K:void 0,setMode:U,setColorScheme:V}}const bt="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function vt(e){const{themeId:t,theme:r={},modeStorageKey:s=pe,colorSchemeStorageKey:i=xe,disableTransitionOnChange:h=!1,defaultColorScheme:n,resolveTheme:c}=e,m={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},S=a.createContext(void 0),y=()=>a.useContext(S)||m,k={},g={};function x(_){var ke,Te,we,Me;const{children:I,theme:K,modeStorageKey:U=s,colorSchemeStorageKey:V=i,disableTransitionOnChange:q=h,storageManager:H,storageWindow:f=typeof window>"u"?void 0:window,documentNode:u=typeof document>"u"?void 0:document,colorSchemeNode:p=typeof document>"u"?void 0:document.documentElement,disableNestedContext:b=!1,disableStyleSheetGeneration:G=!1,defaultMode:Z="system",forceThemeRerender:ee=!1,noSsr:te}=_,R=a.useRef(!1),Q=he(),z=a.useContext(S),J=!!z&&!b,oe=a.useMemo(()=>K||(typeof r=="function"?r():r),[K]),se=oe[t],T=se||oe,{colorSchemes:N=k,components:ae=g,cssVarPrefix:l}=T,d=Object.keys(N).filter(M=>!!N[M]).join(","),v=a.useMemo(()=>d.split(","),[d]),w=typeof n=="string"?n:n.light,B=typeof n=="string"?n:n.dark,de=N[w]&&N[B]?Z:((Te=(ke=N[T.defaultColorScheme])==null?void 0:ke.palette)==null?void 0:Te.mode)||((we=T.palette)==null?void 0:we.mode),{mode:Ae,setMode:ge,systemMode:ye,lightColorScheme:Se,darkColorScheme:Ce,colorScheme:Oe,setColorScheme:be}=Ct({supportedColorSchemes:v,defaultLightColorScheme:w,defaultDarkColorScheme:B,modeStorageKey:U,colorSchemeStorageKey:V,defaultMode:de,storageManager:H,storageWindow:f,noSsr:te});let ue=Ae,W=Oe;J&&(ue=z.mode,W=z.colorScheme);let ie=W||T.defaultColorScheme;T.vars&&!ee&&(ie=T.defaultColorScheme);const re=a.useMemo(()=>{var Y;const M=((Y=T.generateThemeVars)==null?void 0:Y.call(T))||T.vars,j={...T,components:ae,colorSchemes:N,cssVarPrefix:l,vars:M};if(typeof j.generateSpacing=="function"&&(j.spacing=j.generateSpacing()),ie){const A=N[ie];A&&typeof A=="object"&&Object.keys(A).forEach(D=>{A[D]&&typeof A[D]=="object"?j[D]={...j[D],...A[D]}:j[D]=A[D]})}return c?c(j):j},[T,ie,ae,N,l]),ne=T.colorSchemeSelector;_e(()=>{if(W&&p&&ne&&ne!=="media"){const M=ne;let j=ne;if(M==="class"&&(j=".%s"),M==="data"&&(j="[data-%s]"),M!=null&&M.startsWith("data-")&&!M.includes("%s")&&(j=`[${M}="%s"]`),j.startsWith("."))p.classList.remove(...v.map(Y=>j.substring(1).replace("%s",Y))),p.classList.add(j.substring(1).replace("%s",W));else{const Y=j.replace("%s",W).match(/\[([^\]]+)\]/);if(Y){const[A,D]=Y[1].split("=");D||v.forEach(Ge=>{p.removeAttribute(A.replace(W,Ge))}),p.setAttribute(A,D?D.replace(/"|'/g,""):"")}else p.setAttribute(j,W)}}},[W,ne,p,v]),a.useEffect(()=>{let M;if(q&&R.current&&u){const j=u.createElement("style");j.appendChild(u.createTextNode(bt)),u.head.appendChild(j),window.getComputedStyle(u.body),M=setTimeout(()=>{u.head.removeChild(j)},1)}return()=>{clearTimeout(M)}},[W,q,u]),a.useEffect(()=>(R.current=!0,()=>{R.current=!1}),[]);const Fe=a.useMemo(()=>({allColorSchemes:v,colorScheme:W,darkColorScheme:Ce,lightColorScheme:Se,mode:ue,setColorScheme:be,setMode:ge,systemMode:ye}),[v,W,Ce,Se,ue,be,ge,ye,re.colorSchemeSelector]);let ve=!0;(G||T.cssVariables===!1||J&&(Q==null?void 0:Q.cssVarPrefix)===l)&&(ve=!1);const je=o.jsxs(a.Fragment,{children:[o.jsx(De,{themeId:se?t:void 0,theme:re,children:I}),ve&&o.jsx(Ye,{styles:((Me=re.generateStyleSheets)==null?void 0:Me.call(re))||[]})]});return J?je:o.jsx(S.Provider,{value:Fe,children:je})}const C=typeof n=="string"?n:n.light,$=typeof n=="string"?n:n.dark;return{CssVarsProvider:x,useColorScheme:y,getInitColorSchemeScript:_=>xt({colorSchemeStorageKey:i,defaultLightColorScheme:C,defaultDarkColorScheme:$,modeStorageKey:s,..._})}}const jt=Ze(),kt=ct("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`maxWidth${fe(String(r.maxWidth))}`],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),Tt=e=>lt({props:e,name:"MuiContainer",defaultTheme:jt}),wt=(e,t)=>{const r=m=>et(t,m),{classes:s,fixed:i,disableGutters:h,maxWidth:n}=e,c={root:["root",n&&`maxWidth${fe(String(n))}`,i&&"fixed",h&&"disableGutters"]};return Xe(c,r,s)};function Mt(e={}){const{createStyledComponent:t=kt,useThemeProps:r=Tt,componentName:s="MuiContainer"}=e,i=t(({theme:n,ownerState:c})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!c.disableGutters&&{paddingLeft:n.spacing(2),paddingRight:n.spacing(2),[n.breakpoints.up("sm")]:{paddingLeft:n.spacing(3),paddingRight:n.spacing(3)}}}),({theme:n,ownerState:c})=>c.fixed&&Object.keys(n.breakpoints.values).reduce((m,S)=>{const y=S,k=n.breakpoints.values[y];return k!==0&&(m[n.breakpoints.up(y)]={maxWidth:`${k}${n.breakpoints.unit}`}),m},{}),({theme:n,ownerState:c})=>({...c.maxWidth==="xs"&&{[n.breakpoints.up("xs")]:{maxWidth:Math.max(n.breakpoints.values.xs,444)}},...c.maxWidth&&c.maxWidth!=="xs"&&{[n.breakpoints.up(c.maxWidth)]:{maxWidth:`${n.breakpoints.values[c.maxWidth]}${n.breakpoints.unit}`}}}));return a.forwardRef(function(c,m){const S=r(c),{className:y,component:k="div",disableGutters:g=!1,fixed:x=!1,maxWidth:C="lg",classes:$,...F}=S,_={...S,component:k,disableGutters:g,fixed:x,maxWidth:C},I=wt(_,s);return o.jsx(i,{as:k,ownerState:_,className:Qe(I.root,y),ref:m,...F})})}function Et({theme:e,...t}){const r=X in e?e[X]:void 0;return o.jsx(De,{...t,themeId:r?X:void 0,theme:r||e})}const ce={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:Pt}=vt({themeId:X,theme:()=>Ne({cssVariables:!0}),colorSchemeStorageKey:ce.colorSchemeStorageKey,modeStorageKey:ce.modeStorageKey,defaultColorScheme:{light:ce.defaultLightColorScheme,dark:ce.defaultDarkColorScheme},resolveTheme:e=>{const t={...e,typography:tt(e.palette,e.typography)};return t.unstable_sx=function(s){return ot({sx:s,theme:this})},t}}),Lt=Pt;function $t({theme:e,...t}){const r=a.useMemo(()=>{if(typeof e=="function")return e;const s=X in e?e[X]:e;return"colorSchemes"in s?null:"vars"in s?e:{...e,vars:null}},[e]);return r?o.jsx(Et,{theme:r,...t}):o.jsx(Lt,{theme:e,...t})}const _t=Mt({createStyledComponent:rt("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`maxWidth${fe(String(r.maxWidth))}`],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),useThemeProps:e=>nt({props:e,name:"MuiContainer"})});function Ot(){const[e,t]=a.useState(()=>{const l=localStorage.getItem("jwt");if(!l)return null;try{return JSON.parse(atob(l.split(".")[1]))}catch{return null}}),[r,s]=a.useState(""),[i,h]=a.useState({first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",email:(e==null?void 0:e.email)||"",address:(e==null?void 0:e.address)||"",phone:(e==null?void 0:e.phone)||""}),[n,c]=a.useState("login"),[m,S]=a.useState(""),[y,k]=a.useState(""),[g,x]=a.useState(""),[C,$]=a.useState(""),[F,_]=a.useState(""),[I,K]=a.useState(""),[U,V]=a.useState(""),[q,H]=a.useState(!1),[f,u]=a.useState(!1),p=async l=>{l.preventDefault(),H(!0),s("");try{const w=await fetch(n==="login"?"/.netlify/functions/login-user":"/.netlify/functions/register-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n==="login"?{username:m,password:y}:{username:m,password:y,first_name:g,last_name:C,address:I,phone:U})}),B=await w.json();if(w.ok)if(n==="login"){s("Login successful!"),localStorage.setItem("jwt",B.token);try{const de=JSON.parse(atob(B.token.split(".")[1]));t(de)}catch{t({username:m})}}else s("Registration successful! You can now log in."),c("login");else s(B.error||"Error occurred")}catch{s("Network error")}H(!1)},b=()=>{localStorage.removeItem("jwt"),t(null),s("Logged out successfully."),u(!1)},G=Ne({palette:{mode:"light",primary:{main:"#19a974"},background:{default:"#f7f7f7",paper:"#ffffff"},text:{primary:"#222",secondary:"#555"}}}),[Z,ee]=a.useState(null),[te,R]=a.useState(""),[Q,z]=a.useState(null),[J,oe]=a.useState(0),[se,T]=a.useState(null),[N,ae]=a.useState(null);return Ie.useEffect(()=>{async function l(){try{const d=localStorage.getItem("jwt");if(!d)return;const v=await fetch("/.netlify/functions/get-user",{headers:{Authorization:`Bearer ${d}`}});if(!v.ok)return;const w=await v.json();w&&w.user&&(T(!!w.user.tax_exempt_status),ae(w.user.tax_exempt_exp_date||null),t(B=>({...B||{},...w.user})))}catch(d){console.error("Failed to fetch profile",d)}}l()},[]),o.jsxs($t,{theme:G,children:[o.jsx(Ue,{}),o.jsx(_t,{maxWidth:"sm",children:o.jsx(O,{sx:{mt:6},children:o.jsx(st,{elevation:6,sx:{p:4,borderRadius:3,bgcolor:"background.paper"},children:e?o.jsxs(O,{children:[o.jsxs(P,{variant:"h4",align:"center",gutterBottom:!0,color:"text.primary",children:["Welcome, ",e.first_name," ",e.last_name,"!"]}),o.jsxs(O,{sx:{display:"flex",justifyContent:"center",mb:3,gap:2},children:[o.jsx(L,{variant:"outlined",color:"primary",component:le,to:"#account-info",sx:{fontWeight:600},children:"Account Info"}),o.jsx(L,{variant:"outlined",color:"primary",component:le,to:"#tax-exemption",sx:{fontWeight:600},children:"Tax Exemption"}),e.user_type==="admin"&&o.jsx(L,{variant:"outlined",color:"secondary",component:le,to:"/orders",sx:{fontWeight:600},children:"Order Dashboard"})]}),o.jsxs(O,{id:"account-info",sx:{mb:3,p:2,borderRadius:2,bgcolor:"background.default",color:"text.primary"},children:[o.jsxs(P,{variant:"body1",children:[o.jsx("strong",{children:"Username:"})," ",e.username]}),o.jsxs(P,{variant:"body1",children:[o.jsx("strong",{children:"Email:"})," ",e.email||"—"]}),o.jsxs(P,{variant:"body1",children:[o.jsx("strong",{children:"Address:"})," ",e.address||"—"]}),o.jsxs(P,{variant:"body1",children:[o.jsx("strong",{children:"Phone:"})," ",e.phone||"—"]})]}),o.jsxs(O,{id:"tax-exemption",sx:{mb:3,p:2,borderRadius:2,bgcolor:"background.default",color:"text.primary"},children:[o.jsx(P,{variant:"h6",sx:{mb:1},children:"Tax Exemption"}),o.jsx(E,{label:"Tax Exemption",variant:"filled",value:se?"Tax Exempt":"Not Tax Exempt",InputProps:{readOnly:!0},fullWidth:!0,sx:{mb:2}}),o.jsx(E,{label:"Tax Exemption Expiration",variant:"filled",value:N?new Date(N).toLocaleDateString():"—",InputProps:{readOnly:!0},fullWidth:!0,sx:{mb:2}}),o.jsx(P,{variant:"body2",sx:{mb:1},children:"Upload your tax exemption document (PDF or image). Our team will review and update your status."}),o.jsx("input",{id:"tax-file",type:"file",accept:"application/pdf,image/*",onChange:l=>{const d=l.target.files&&l.target.files[0];if(ee(d),d&&d.type&&d.type.startsWith("image/")){const v=URL.createObjectURL(d);z(v)}else z(null)},style:{marginBottom:8}}),Q&&o.jsx("img",{src:Q,alt:"preview",style:{maxWidth:"100%",marginBottom:8}}),o.jsxs(O,{sx:{display:"flex",gap:1,mb:1},children:[o.jsx(L,{variant:"contained",color:"primary",disabled:!Z,onClick:()=>{if(!Z)return;R(""),oe(0);const l=new FormData;l.append("file",Z),l.append("username",e.username||"");const d=new XMLHttpRequest;d.open("POST","/.netlify/functions/upload-tax-exempt"),d.upload.onprogress=v=>{v.lengthComputable&&oe(Math.round(v.loaded/v.total*100))},d.onload=()=>{try{const v=JSON.parse(d.responseText||"{}");if(d.status>=200&&d.status<300){R("Upload successful. We will review and update your tax exemption status."),ee(null),z(null);const w=document.getElementById("tax-file");w&&(w.value="")}else R(v.error||"Upload failed")}catch{R("Upload returned unexpected response")}},d.onerror=()=>R("Network error during upload"),d.send(l)},children:"Upload"}),o.jsx(L,{variant:"outlined",color:"secondary",onClick:()=>{ee(null);const l=document.getElementById("tax-file");l&&(l.value=""),R("")},children:"Cancel"})]}),J>0&&J<100&&o.jsxs(P,{variant:"body2",children:["Uploading: ",J,"%"]}),te&&o.jsx(P,{variant:"body2",color:te.toLowerCase().includes("success")?"primary":"error",children:te})]}),f?o.jsxs(O,{component:"form",onSubmit:async l=>{l.preventDefault(),s("");try{const d=await fetch("/.netlify/functions/update-user",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("jwt")}`},body:JSON.stringify(i)}),v=await d.json();d.ok?(t({...e,...i}),u(!1),s("Profile updated successfully.")):s(v.error||"Error updating profile.")}catch{s("Network error updating profile.")}},sx:{display:"flex",flexDirection:"column",gap:2,mb:2},children:[o.jsx(E,{label:"First Name",variant:"filled",value:i.first_name,onChange:l=>h(d=>({...d,first_name:l.target.value})),required:!0,color:"primary"}),o.jsx(E,{label:"Last Name",variant:"filled",value:i.last_name,onChange:l=>h(d=>({...d,last_name:l.target.value})),required:!0,color:"primary"}),o.jsx(E,{label:"Email",variant:"filled",value:i.email,onChange:l=>h(d=>({...d,email:l.target.value})),type:"email",color:"primary"}),o.jsx(E,{label:"Address",variant:"filled",value:i.address,onChange:l=>h(d=>({...d,address:l.target.value})),color:"primary"}),o.jsx(E,{label:"Phone Number",variant:"filled",value:i.phone,onChange:l=>h(d=>({...d,phone:l.target.value})),type:"tel",color:"primary"}),o.jsx(L,{type:"submit",variant:"contained",color:"primary",sx:{fontWeight:600},children:"Save Changes"}),o.jsx(L,{type:"button",variant:"outlined",color:"secondary",sx:{mt:1},onClick:()=>u(!1),children:"Cancel"})]}):o.jsx(L,{fullWidth:!0,variant:"contained",color:"primary",sx:{mb:2,fontWeight:600},onClick:()=>u(!0),children:"Edit Profile"}),o.jsx(L,{fullWidth:!0,variant:"contained",color:"error",sx:{fontWeight:600},onClick:b,children:"Logout"}),r&&o.jsx(P,{sx:{mt:2},align:"center",color:r.includes("success")?"primary":"error",fontWeight:600,children:r})]}):o.jsxs(O,{children:[o.jsx(P,{variant:"h4",align:"center",gutterBottom:!0,color:"text.primary",children:n==="login"?"Login":"Create Account"}),o.jsxs(O,{component:"form",onSubmit:p,sx:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx(E,{label:"Username",variant:"filled",value:m,onChange:l=>S(l.target.value),required:!0,color:"primary"}),o.jsx(E,{label:"Password",variant:"filled",type:"password",value:y,onChange:l=>k(l.target.value),required:!0,color:"primary"}),n==="register"&&o.jsxs(o.Fragment,{children:[o.jsx(E,{label:"First Name",variant:"filled",value:g,onChange:l=>x(l.target.value),required:!0,color:"primary"}),o.jsx(E,{label:"Last Name",variant:"filled",value:C,onChange:l=>$(l.target.value),required:!0,color:"primary"}),o.jsx(E,{label:"Address",variant:"filled",value:I,onChange:l=>K(l.target.value),color:"primary"}),o.jsx(E,{label:"Phone Number",variant:"filled",value:U,onChange:l=>V(l.target.value),type:"tel",color:"primary"})]}),o.jsx(L,{type:"submit",disabled:q,variant:"contained",color:"primary",sx:{fontWeight:600},children:q?"Please wait...":n==="login"?"Login":"Register"})]}),o.jsxs(O,{sx:{mt:2,textAlign:"center",display:"flex",flexDirection:"column",gap:1},children:[o.jsx(L,{variant:"text",color:"primary",onClick:()=>c(n==="login"?"register":"login"),sx:{fontWeight:600},children:n==="login"?"Create an account":"Already have an account? Login"}),n==="login"&&o.jsx(L,{variant:"text",color:"secondary",sx:{fontWeight:600},component:le,to:"/recover-password",children:"Forgot Password?"})]}),r&&o.jsx(P,{sx:{mt:2},align:"center",color:r.includes("success")?"primary":"error",fontWeight:600,children:r})]})})})})]})}export{Ot as default};
