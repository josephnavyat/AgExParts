import{R as o,j as N}from"./index-gi7GTMaL.js";function g({initialValue:T,product:e,dispatch:r,immediateDispatch:b=!1,updateOnBlurOnly:u=!1,showLimit:y}){const[s,f]=o.useState(()=>String(Number(T||0)));return o.useEffect(()=>{f(String(Number(T||0)))},[T]),o.useEffect(()=>{if(b||u)return;const n=Number(s||0),t=Number(T||0);if(n===t)return;const a=setTimeout(()=>{const i=Number(e.inventory??e.quantity??0);Number.isFinite(i)&&i>0&&n>i?(typeof y=="function"&&y(e.id),r({type:"SET_QUANTITY",product:e,quantity:i}),f(String(i))):(r({type:"SET_QUANTITY",product:e,quantity:n}),f(String(n)))},600);return()=>clearTimeout(a)},[s,T,e,r,b,u,y]),N.jsx("input",{"aria-label":`Quantity for ${(e==null?void 0:e.name)||""}`,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:s,className:"qty-input",onChange:n=>{const t=(n.target.value||"").replace(/\D/g,"");if(f(t),b){const a=Number(t||0),i=Number(e.inventory??e.quantity??0);Number.isFinite(i)&&i>0&&a>i?(typeof y=="function"&&y(e.id),r({type:"SET_QUANTITY",product:e,quantity:i}),f(String(i))):r({type:"SET_QUANTITY",product:e,quantity:a})}},onKeyDown:n=>{if(n.key==="Enter"){const t=Number(s||0),a=Number(e.inventory??e.quantity??0);Number.isFinite(a)&&a>0&&t>a?(typeof y=="function"&&y(e.id),r({type:"SET_QUANTITY",product:e,quantity:a}),f(String(a))):(r({type:"SET_QUANTITY",product:e,quantity:t}),f(String(t)))}},onBlur:()=>{const n=Number(s||0),t=Number(e.inventory??e.quantity??0);Number.isFinite(t)&&t>0&&n>t?(typeof y=="function"&&y(e.id),r({type:"SET_QUANTITY",product:e,quantity:t}),f(String(t))):(r({type:"SET_QUANTITY",product:e,quantity:n}),f(String(n)))},style:{width:`${Math.max(1,Math.min((s||"").length||0,4))}ch`,textAlign:"center",fontWeight:600,color:"#222",fontSize:"1.1rem",padding:"6px 8px",borderRadius:6,border:"1px solid #d6d6d6",boxSizing:"content-box"},onClick:n=>n.stopPropagation(),onMouseDown:n=>n.stopPropagation()})}export{g as Q};
