import{R as F,j as e,a as D,r as l,u as U,b as q,g as z,L as Q}from"./index-PZtE8jMc.js";import{g as V}from"./imageUrl-BC-b4leq.js";import{Q as H}from"./QuantityInput-CgpvvZHz.js";function C(o){return V(o)}function Y({src:o,alt:i="",style:f={},className:y="",loading:j="lazy",...a}){const[h,d]=F.useState(!1),g=h?"/logo.png":o||"/logo.png";return e.jsx("img",{src:g,alt:i,style:f,className:y,loading:j,onError:()=>d(!0),...a})}function Z(){const{id:o}=D(),[i,f]=l.useState(null),[y,j]=l.useState(!0),[a,h]=l.useState([]),[d,g]=l.useState([]),[v,I]=l.useState([]),[T,_]=l.useState(0),{dispatch:p,cart:M}=U(),k=q();l.useEffect(()=>{let t=!1;async function s(){try{const n=await(await fetch("/.netlify/functions/get-data")).json(),R=(Array.isArray(n)?n:Array.isArray(n.products)?n.products:[]).find(m=>String(m.id)===String(o));t||f(R||null)}catch(r){console.error(r)}finally{t||j(!1)}}return s(),()=>{t=!0}},[o]),l.useEffect(()=>{if(!i||!i.sku)return;let t=!0;return fetch(`/.netlify/functions/get-product-attributes?sku=${encodeURIComponent(i.sku)}`).then(s=>s.ok?s.json():[]).then(s=>{t&&h(Array.isArray(s)?s:[])}).catch(()=>h([])),fetch(`/.netlify/functions/get-compatibility-by-sku?sku=${encodeURIComponent(i.sku)}`).then(s=>s.ok?s.json():{compatibility:[]}).then(s=>{t&&g(Array.isArray(s.compatibility)?s.compatibility:[])}).catch(()=>g([])),()=>{t=!1}},[i]),l.useEffect(()=>{if(!i){I([]),_(0);return}const t=String(i.image||"").split("/").pop()||"",s=t.lastIndexOf("."),r=s!==-1?t.slice(0,s):t,n=s!==-1?t.slice(s):"",N=C(t),R=[t,`${r}.webp`,`${r}.thumb.webp`,`${r}_2${n}`,`${r}_3${n}`,`${r}_4${n}`,`${r}_5${n}`];let m=!1;return(async()=>{const S=new Set;if(S.add(N),await Promise.all(R.map(async A=>{try{const b=C(A);if(b===N)return;const B=await fetch(b,{method:"HEAD"});B&&B.ok&&S.add(b)}catch{}})),!m){const A=Array.from(S);I(A),_(0)}})(),()=>{m=!0}},[i]);const $=()=>{i&&p({type:"ADD_TO_CART",product:i,quantity:1})},W=()=>{i&&p({type:"SUBTRACT_FROM_CART",product:i})},L=()=>{i&&p({type:"REMOVE_FROM_CART",id:i.id})},x=i?z(M,i.id):0,c=i?Number(i.inventory??i.quantity??0):0,u=c<=0,w=i?x>=c&&c>0:!1,O=(()=>{if(!i)return 0;const t=["weight","weight_lbs","shipping_weight","ship_weight","ship_weight_lbs","unit_weight"];for(const s of t)if(i[s]!==void 0&&i[s]!==null){const r=Number(i[s]);if(!Number.isNaN(r)&&r>0)return r}if(Array.isArray(a))for(const s of a)try{if((s.attribute_name||"").toString().toLowerCase().includes("weight")){const n=s.value_number!==void 0&&s.value_number!==null?Number(s.value_number):s.value_text?Number(String(s.value_text).replace(/[^0-9.]/g,"")):NaN;if(!Number.isNaN(n)&&n>0)return n}}catch{}return 0})(),E=Math.max(1,x||1),P=O*E;return y?e.jsx("div",{style:{textAlign:"center",padding:24},children:"Loading product…"}):i?e.jsxs("div",{className:"product-detail-new",style:{display:"flex",maxWidth:1100,margin:"2rem auto",padding:"1rem",background:"#fff",borderRadius:8,gap:32,alignItems:"center"},children:[e.jsxs("div",{className:"product-detail-new__media",style:{flex:"0 0 420px",display:"flex",alignItems:"center",flexDirection:"column",gap:12,textAlign:"center"},children:[e.jsx("div",{style:{width:360,height:360,borderRadius:8,overflow:"hidden",background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.06)"},children:e.jsx(Y,{src:v[T]||C(i.image||""),alt:i.name,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),v.length>1&&e.jsx("div",{style:{display:"flex",gap:8,marginTop:6,flexWrap:"wrap"},children:v.map((t,s)=>e.jsx("button",{onClick:()=>_(s),"aria-label":`View image ${s+1}`,style:{border:T===s?"2px solid #111":"1px solid #eee",padding:0,background:"#fff",cursor:"pointer",borderRadius:6},children:e.jsx("img",{src:t,alt:`thumb-${s+1}`,style:{width:64,height:64,objectFit:"cover",display:"block",borderRadius:6}})},t))}),e.jsxs("div",{className:"pd-side-sections pd-side-sections--desktop",style:{width:"100%",marginTop:12},children:[e.jsx("div",{style:{marginBottom:12},children:e.jsx("div",{className:"pd-part-divider","aria-hidden":"true",style:{height:1,background:"#e6e6e6",width:"100%"}})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 0 12px 0"},children:[e.jsx("h3",{style:{margin:0},children:"OEM Replacement"}),e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)",marginLeft:12}})]}),e.jsxs("div",{style:{color:"#444",fontSize:"1rem"},children:[!1,e.jsx("div",{style:{marginBottom:6},children:i.oem_pn?i.oem_pn:i.oem_part_number?i.oem_part_number:e.jsx("span",{style:{color:"#888"},children:"No OEM part number available."})}),i.replaces&&e.jsxs("div",{style:{color:"#666",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Replaces:"})," ",i.replaces]})]}),e.jsx("div",{style:{marginBottom:12},children:e.jsx("div",{className:"pd-part-divider","aria-hidden":"true",style:{height:1,background:"#e6e6e6",width:"100%"}})}),e.jsxs("div",{className:"pd-section",style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 0 12px 0"},children:[e.jsx("h3",{style:{margin:0},children:"Part Attributes"}),e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)",marginLeft:12}})]}),a.length>0?e.jsx("table",{className:"compat-table",style:{width:"100%",borderCollapse:"collapse"},children:e.jsx("tbody",{children:a.map((t,s)=>e.jsxs("tr",{style:{borderBottom:s<a.length-1?"1px solid #f1f1f1":"none"},children:[e.jsx("td",{style:{padding:"8px 6px",fontWeight:700},children:t.attribute_name}),e.jsxs("td",{style:{padding:"8px 6px"},children:[t.value_text||(t.value_number!==void 0&&t.value_number!==null?t.value_number:t.value_bool===!0?"Yes":t.value_bool===!1?"No":""),t.unit?` ${t.unit}`:""]})]},t.attribute_name))})}):e.jsx("div",{style:{color:"#888"},children:"No attributes available."})]}),e.jsxs("div",{className:"pd-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 0 12px 0"},children:[e.jsx("h3",{style:{margin:0},children:"Machine Compatibility"}),e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)",marginLeft:12}})]}),d.length>0?e.jsxs("table",{className:"compat-table",style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",borderBottom:"2px solid #eee"},children:[e.jsx("th",{style:{padding:"8px 6px",width:"33%"},children:"Manufacturer"}),e.jsx("th",{style:{padding:"8px 6px",width:"33%"},children:"Machine Type"}),e.jsx("th",{style:{padding:"8px 6px",width:"34%"},children:"Model"})]})}),e.jsx("tbody",{children:d.map((t,s)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f1f1"},children:[e.jsx("td",{style:{padding:"8px 6px"},children:t.manufacturer||"-"}),e.jsx("td",{style:{padding:"8px 6px"},children:t.machine_type||"-"}),e.jsx("td",{style:{padding:"8px 6px"},children:t.model||"-"})]},s))})]}):e.jsx("div",{style:{color:"#888"},children:"No compatibility data available."})]})]})]}),e.jsxs("div",{className:"product-detail-new__content",style:{flex:"1 1 auto",alignSelf:"flex-start"},children:[e.jsx("div",{style:{marginBottom:10},children:e.jsx("button",{onClick:()=>k(-1)||k("/catalog"),style:{background:"transparent",border:"1px solid #e6e6e6",padding:"6px 10px",borderRadius:6,cursor:"pointer"},children:"← Back"})}),e.jsx("h1",{style:{fontSize:"1.75rem",margin:0},children:i.name||"Product Title"}),i.sku&&e.jsx("div",{style:{marginTop:6,color:"#666",fontWeight:600},children:i.sku}),i.part_number&&e.jsxs("div",{style:{marginTop:8,color:"#444",fontWeight:600},children:["Part #: ",i.part_number]}),e.jsx("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:12},children:e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)"}})}),e.jsx("div",{style:{marginTop:12},children:e.jsx("div",{className:"pd-desc",children:e.jsx("p",{className:"pd-desc-text",children:i.description||"This is a brief, product description that highlights key features and uses."})})}),e.jsxs("div",{className:"pd-actions pd-actions--inline",style:{marginTop:32,display:"flex",alignItems:"center",gap:16},children:[e.jsxs("div",{style:{fontSize:"1.6rem",fontWeight:800},children:["$",Number(i.price||0).toFixed(2)]}),x>0?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid #e6e6e6",borderRadius:6,overflow:"hidden"},children:[e.jsx("button",{"aria-label":"Decrease quantity",onClick:W,style:{padding:"8px 10px",border:"none",background:"#fff",cursor:"pointer"},children:"−"}),e.jsx("div",{style:{padding:"8px 12px",minWidth:44,textAlign:"center",fontWeight:600},children:e.jsx(H,{initialValue:x,product:i,dispatch:p,updateOnBlurOnly:!0,onLimit:t=>{}})}),e.jsx("button",{"aria-label":"Increase quantity",onClick:$,disabled:w,style:{padding:"8px 10px",border:"none",background:w?"#f7f7f7":"#fff",cursor:w?"not-allowed":"pointer"},children:"+"})]}),e.jsx("button",{onClick:L,style:{background:"#fff",border:"1px solid #ddd",padding:"8px 12px",borderRadius:6,cursor:"pointer"},children:"Remove"})]}):e.jsx("button",{onClick:$,disabled:u,style:{background:u?"#f3f3f3":"var(--gallery-btn-bg, var(--brand))",color:u?"#999":"var(--gallery-btn-text, #fff)",border:"none",padding:"12px 20px",borderRadius:6,cursor:u?"not-allowed":"pointer"},children:u?"Out of stock":"Add to cart"})]}),P>100?e.jsx("div",{style:{marginTop:18},children:e.jsx("button",{onClick:()=>{x<=0&&p({type:"ADD_TO_CART",product:i,quantity:1}),k("/checkout")},style:{background:"#1f8f5a",color:"#fff",border:"none",padding:"12px 18px",borderRadius:8,cursor:"pointer"},children:"Proceed to Checkout (Freight)"})}):e.jsx("div",{style:{marginTop:18},children:e.jsx(Q,{to:`/freight-quote?sku=${encodeURIComponent(i.sku||"")}`,style:{textDecoration:"none"},children:e.jsx("button",{style:{background:"#fff",color:"#111",border:"1px solid #ddd",padding:"10px 16px",borderRadius:8,cursor:"pointer"},children:"Request Freight Quote"})})}),c<=20&&c>0&&e.jsxs("div",{style:{marginTop:8,color:"orange",fontWeight:700},children:["Low Stock: ",c," Available"]}),e.jsxs("div",{className:"pd-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 0 12px 0"},children:[e.jsx("h3",{style:{margin:0},children:"Part Attributes"}),e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)",marginLeft:12}})]}),a.length>0?e.jsx("table",{className:"compat-table",style:{width:"100%",borderCollapse:"collapse"},children:e.jsx("tbody",{children:a.map((t,s)=>e.jsxs("tr",{style:{borderBottom:s<a.length-1?"1px solid #f1f1f1":"none"},children:[e.jsx("td",{style:{padding:"8px 6px",fontWeight:700},children:t.attribute_name}),e.jsxs("td",{style:{padding:"8px 6px"},children:[t.value_text||(t.value_number!==void 0&&t.value_number!==null?t.value_number:t.value_bool===!0?"Yes":t.value_bool===!1?"No":""),t.unit?` ${t.unit}`:""]})]},t.attribute_name))})}):e.jsx("div",{style:{color:"#888"},children:"No attributes available."})]}),a&&a.length>0&&d&&d.length>0&&e.jsx("div",{style:{marginTop:12,marginBottom:12}}),e.jsxs("div",{className:"pd-section pd-compat-top",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"8px 0 12px 0"},children:[e.jsx("h3",{style:{margin:0},children:"Machine Compatibility"}),e.jsx("div",{style:{flex:1,height:6,background:"#3b3b3b",borderRadius:3,boxShadow:"0 4px 16px rgba(122,133,153,0.08)",marginLeft:12}})]}),d.length>0?e.jsxs("table",{className:"compat-table",style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",borderBottom:"2px solid #eee"},children:[e.jsx("th",{style:{padding:"8px 6px",width:"33%"},children:"Manufacturer"}),e.jsx("th",{style:{padding:"8px 6px",width:"33%"},children:"Machine Type"}),e.jsx("th",{style:{padding:"8px 6px",width:"34%"},children:"Model"})]})}),e.jsx("tbody",{children:d.map((t,s)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f1f1"},children:[e.jsx("td",{style:{padding:"8px 6px"},children:t.manufacturer||"-"}),e.jsx("td",{style:{padding:"8px 6px"},children:t.machine_type||"-"}),e.jsx("td",{style:{padding:"8px 6px"},children:t.model||"-"})]},s))})]}):e.jsx("div",{style:{color:"#888"},children:"No compatibility data available."})]})]})]}):e.jsx("div",{style:{textAlign:"center",padding:24},children:"Product not found."})}export{Z as default};
