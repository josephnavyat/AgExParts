import{r,u as J,j as e,L as Q,g as V}from"./index-DQiy-OUL.js";/* empty css                       */import{S as K}from"./SmartImage-CfQVuS4Q.js";import"./getImageUrl-uc-Sp53x.js";function se(){window.matchMedia("(max-width: 700px)").matches;const[p,S]=r.useState([]),[h,C]=r.useState([]),[U,B]=r.useState(!0),[F,E]=r.useState(null),[g,w]=r.useState(!1),[L,D]=r.useState(!1),[y,O]=r.useState(""),[o,I]=r.useState(""),[c,k]=r.useState(""),[f,b]=r.useState(""),[A,z]=r.useState(""),[m,M]=r.useState(""),[j,T]=r.useState("");r.useEffect(()=>{const t=new AbortController;return(async()=>{try{const i=await fetch("/.netlify/functions/get-data",{signal:t.signal});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const d=await i.json();Array.isArray(d)?(S(d),C([])):d&&Array.isArray(d.products)?(S(d.products),C(Array.isArray(d.compatibility)?d.compatibility:[]),Array.isArray(d.compat_links)?_(d.compat_links):_([])):(S([]),C([]),_([]))}catch(i){i.name!=="AbortError"&&E(i.message+(i.response?" "+JSON.stringify(i.response):""))}finally{B(!1)}})(),()=>t.abort()},[]);const[v,$]=r.useState(50),[x,N]=r.useState(1),{dispatch:q,cart:R}=J(),[W,_]=r.useState([]);return e.jsxs("div",{className:"simple-gallery-root",role:"main",children:[e.jsxs("div",{className:"simple-gallery-header",children:[e.jsx("h2",{className:"simple-gallery-title distressed",children:"Agex Parts"}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:e.jsxs("div",{className:"simple-gallery-perpage",children:[e.jsx("label",{className:"filter-label",htmlFor:"perPageSelect",children:"Show:"}),e.jsx("select",{id:"perPageSelect",className:"filter-select",value:v,onChange:t=>{$(Number(t.target.value)),N(1)},children:[24,48,72,96].map(t=>e.jsxs("option",{value:t,children:[t," per page"]},t))})]})}),e.jsx("button",{className:"simple-gallery-filter-toggle","aria-label":g?"Hide Filters":"Show Filters","aria-pressed":g,"aria-controls":"gallery-filter-pane",onClick:()=>w(t=>!t),style:{position:"fixed",left:0,top:100,zIndex:100,background:"#3a3939",color:"#f3f3f3",border:"none",borderRadius:"0 8px 8px 0",padding:"0.7rem 0.9rem",fontWeight:700,fontSize:"1.1rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",cursor:"pointer",transition:"top 0.3s",display:"block"},id:"filter-toggle-btn",children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),e.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),e.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),e.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),e.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),e.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),e.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:600},children:"Filter"})]})})]}),e.jsx("hr",{className:"simple-gallery-divider"}),e.jsxs("div",{className:"simple-gallery-layout",style:{position:"relative"},children:[e.jsxs("aside",{id:"gallery-filter-pane",className:`simple-gallery-filter-pane${g?"":" simple-gallery-filter-pane--closed"}`,"aria-label":"Product Filters","aria-hidden":!g,tabIndex:g?0:-1,style:{position:"fixed",left:g?0:-340,top:156,zIndex:99,minWidth:260,maxWidth:340,height:"fit-content",marginTop:0,transition:"top 0.3s, left 0.3s"},children:[e.jsxs("div",{className:"simple-gallery-filter-header",style:{cursor:"pointer"},onClick:()=>w(t=>!t),children:["Filters ",g?"▼":"▶"]}),e.jsxs("div",{className:"simple-gallery-filter-content",children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"0.25rem 0 0.5rem 0"},children:e.jsxs("button",{title:"Clear filters","aria-label":"Clear filters",onClick:()=>{I(""),k(""),b(""),M(""),T(""),O(""),D(!1),z(""),N(1),w(!1)},style:{background:"transparent",border:"none",color:"#444",cursor:"pointer",padding:"0.35rem 0.6rem",borderRadius:6,display:"flex",alignItems:"center",gap:8,fontWeight:600},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"4",rx:"1",ry:"1"}),e.jsx("path",{d:"M6 8v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("span",{style:{fontSize:"0.95rem"},children:"Clear filters"})]})}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search...",value:y,onChange:t=>O(t.target.value),list:"product-names-list"}),e.jsx("datalist",{id:"product-names-list",children:[...new Set(p.filter(t=>{const s=String(t.name||"").toLowerCase();return String(t.category||"").toLowerCase()!=="demo"&&!s.includes("demo")&&!s.includes("sample")}).map(t=>t.name).filter(Boolean))].map(t=>e.jsx("option",{value:t},t))}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Category"}),e.jsxs("select",{value:m,onChange:t=>M(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"All Categories"}),[...new Set(p.map(t=>t.category).filter(Boolean))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sub-Category"}),(()=>{const t=m?[...new Set(p.filter(s=>s.category===m).map(s=>s.subcategory).filter(Boolean))]:[];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:j,onChange:s=>T(s.target.value),className:"filter-select",disabled:!m,title:m?t.length===0?"No sub-categories available":"Filter by sub-category":"Select a category first",children:[e.jsx("option",{value:"",children:"All Sub-Categories"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),!m&&e.jsx("div",{className:"filter-hint",children:"Select a category to enable sub-categories"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Manufacturer"}),(()=>{const t=[...new Set((h.length?h.map(s=>s.manufacturer):p.map(s=>s.manufacturer)).filter(Boolean))];return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:o,onChange:s=>{I(s.target.value),k(""),b("")},className:"filter-select",children:[e.jsx("option",{value:"",children:"All Manufacturers"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]}),t.length===0&&e.jsx("div",{className:"filter-hint",children:"No manufacturers available"})]})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Machine Type"}),(()=>{const t=[...new Set((h.length?h.filter(s=>!o||s.manufacturer===o).map(s=>s.machine_type):p.map(s=>s.machine_type)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:c,onChange:s=>{k(s.target.value),b("")},className:"filter-select",disabled:!o,title:o?t.length===0?"No machine types available":"Filter by machine type":"Select a manufacturer to see machine types",children:[e.jsx("option",{value:"",children:"All Machine Types"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Model"}),(()=>{const t=[...new Set((h.length?h.filter(s=>(!o||s.manufacturer===o)&&(!c||s.machine_type===c)).map(s=>s.model):p.map(s=>s.model)).filter(Boolean))];return e.jsx(e.Fragment,{children:e.jsxs("select",{value:f,onChange:s=>b(s.target.value),className:"filter-select",disabled:!c,title:c?t.length===0?"No models available":"Filter by model":"Select a machine type to see models",children:[e.jsx("option",{value:"",children:"All Models"}),t.map(s=>e.jsx("option",{value:s,children:s},s))]})})})()]}),e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Sort by"}),e.jsxs("select",{value:A,onChange:t=>z(t.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"price-asc",children:"Price: Low to High"}),e.jsx("option",{value:"price-desc",children:"Price: High to Low"})]})]})]})]}),e.jsxs("div",{className:"simple-gallery-grid",style:{marginLeft:"",transition:"none"},children:[F?e.jsxs("div",{style:{padding:24,textAlign:"center",color:"red"},role:"alert",children:["Failed to load products: ",F]}):(()=>{const t=!!(o||c||f),s=h.length&&W.length&&t,i=(()=>{if(s){const l={};W.forEach(a=>{!a.machine_compatibility_id||!a.product_sku||(l[a.machine_compatibility_id]=l[a.machine_compatibility_id]||new Set,l[a.machine_compatibility_id].add(a.product_sku))});const n=h.filter(a=>!o||a.manufacturer===o).filter(a=>!c||a.machine_type===c).filter(a=>!f||a.model===f).map(a=>a.id),u=new Set;return n.forEach(a=>{(l[a]||[]).forEach(P=>u.add(P))}),u.size===0?[]:p.filter(a=>u.has(a.sku))}return p})().filter(l=>l.website_visible===!0).filter(l=>!m||l.category===m).filter(l=>!j||l.subcategory===j).filter(l=>s?!0:!o||l.manufacturer===o).filter(l=>s?!0:!c||l.machine_type===c).filter(l=>s?!0:!f||l.model===f).filter(l=>!L||l.quantity>0).filter(l=>{if(!y.trim())return!0;const n=y.toLowerCase();return Object.values(l).some(u=>typeof u=="string"&&u.toLowerCase().includes(n))}).sort((l,n)=>A==="price-asc"?(l.price||0)-(n.price||0):A==="price-desc"?(n.price||0)-(l.price||0):0),d=(x-1)*v,H=d+v;return t&&i.length===0?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#666"},role:"status",children:"No items matched filters."},"no-results"):i.slice(d,H).map(l=>e.jsxs(Q,{to:`/product/${l.id}`,className:"simple-gallery-card",style:{textDecoration:"none"},children:[e.jsx("div",{className:"simple-gallery-image-wrapper",children:e.jsx(K,{src:l.image,alt:l.name,loading:"lazy"})}),l.sku&&e.jsx("div",{className:"simple-gallery-sku",children:l.sku}),e.jsx("h3",{className:"simple-gallery-card-title",title:l.name,children:l.name}),e.jsx("div",{className:"simple-gallery-part-number",children:l.part_number}),e.jsx("div",{className:"simple-gallery-card-price",style:{margin:"8px 0 0 0",fontSize:"1.15rem",fontWeight:700},children:(()=>{const n=Number(l.price),u=Number(l.discount_perc)||0,a=l.discount_end_date?new Date(l.discount_end_date):null,P=new Date;if(u>0&&(!a||P<=a)&&!isNaN(n)){const G=(n*(1-u)).toFixed(2);return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"price-original",children:["$",n.toFixed(2)]}),e.jsxs("span",{className:"price-current",children:["$",G]})]})}else return isNaN(n)?e.jsx("span",{className:"price-current",children:"Price N/A"}):e.jsxs("span",{className:"price-current",children:["$",n.toFixed(2)]})})()}),e.jsx("div",{className:"simple-gallery-card-actions",role:"group","aria-label":"Product Actions",children:(()=>{const n=V(R,l.id);return Number(l.inventory??l.quantity??0)===0?e.jsx("button",{className:"simple-gallery-btn",title:"Out of Stock","aria-label":"Out of Stock",disabled:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,background:"#d33",color:"#fff",border:"none",padding:"0.5rem 0.9rem",borderRadius:6,cursor:"not-allowed",opacity:.9},children:e.jsx("span",{style:{fontWeight:800,fontSize:"0.98rem"},children:"Out of Stock"})}):e.jsxs("button",{className:"simple-gallery-btn primary",onClick:a=>{a.stopPropagation(),a.preventDefault(),q({type:"ADD_TO_CART",product:l})},title:"Add to Cart","aria-label":"Add to Cart",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,position:"relative"},children:[e.jsx("span",{className:"add-to-cart-label",style:{fontWeight:800,fontSize:"0.98rem"},children:"Add to Cart"}),n>0&&e.jsx("span",{className:"qty-bubble",children:n})]})})()})]},l.id))})(),e.jsx("div",{className:"simple-gallery-pagination",children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem auto 0 auto",gap:12,width:"100%"},children:[x>1&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>N(x-1),children:"< Prev"}),e.jsxs("span",{style:{color:"#c3c3c3",fontWeight:500,fontSize:"1.05rem",margin:"0 1rem"},children:["Page ",x]}),p.filter(t=>!m||t.category===m).filter(t=>!j||t.subcategory===j).filter(t=>!o||t.manufacturer===o).filter(t=>!c||t.machine_type===c).filter(t=>!f||t.model===f).filter(t=>!L||t.quantity>0).filter(t=>{if(!y.trim())return!0;const s=y.toLowerCase();return Object.values(t).some(i=>typeof i=="string"&&i.toLowerCase().includes(s))}).length>x*v&&e.jsx("button",{className:"simple-gallery-btn secondary",onClick:()=>N(x+1),children:"Next >"})]})})]})]})]})}export{se as default};
